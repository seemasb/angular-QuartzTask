import './polyfills.server.mjs';
import{A as se,B as wn,C as Sr,D as ne,E as xe,F as B,G as ve,H as rt,I as je,P as Ir,Q as Cn,S as Fr,T as It,U as Ge,V as Or,W as Pr,Z as Tr,a as Mr,b as Vr,c as xr,d as tt,da as kr,e as At,f as mn,g as Mt,h as Me,i as Ke,j as Vt,k as ie,l as gn,m as xt,n as St,o as yn,p as vn,q as _n,r as X,s as U,t as Ve,u as ge,v as ye,w as bn,x as nt,y as P,z as F}from"./chunk-SEIK7S2L.mjs";import{a as O,b as K,h as Be}from"./chunk-KRLCULJA.mjs";var Hr=(()=>{let e=class e{constructor(r,i){this._renderer=r,this._elementRef=i,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(r,i){this._renderer.setProperty(this._elementRef.nativeElement,r,i)}registerOnTouched(r){this.onTouched=r}registerOnChange(r){this.onChange=r}setDisabledState(r){this.setProperty("disabled",r)}};e.\u0275fac=function(i){return new(i||e)(U(_n),U(vn))},e.\u0275dir=ie({type:e});let t=e;return t})(),Lr=(()=>{let e=class e extends Hr{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=yn(e)))(s||e)}})(),e.\u0275dir=ie({type:e,features:[ge]});let t=e;return t})(),En=new Me("NgValueAccessor");var hs={provide:En,useExisting:tt(()=>jt),multi:!0};function fs(){let t=Cn()?Cn().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}var ps=new Me("CompositionEventMode"),jt=(()=>{let e=class e extends Hr{constructor(r,i,s){super(r,i),this._compositionMode=s,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!fs())}writeValue(r){let i=r??"";this.setProperty("value",i)}_handleInput(r){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(r)}_compositionStart(){this._composing=!0}_compositionEnd(r){this._composing=!1,this._compositionMode&&this.onChange(r)}};e.\u0275fac=function(i){return new(i||e)(U(_n),U(vn),U(ps,8))},e.\u0275dir=ie({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,s){i&1&&ne("input",function(a){return s._handleInput(a.target.value)})("blur",function(){return s.onTouched()})("compositionstart",function(){return s._compositionStart()})("compositionend",function(a){return s._compositionEnd(a.target.value)})},features:[rt([hs]),ge]});let t=e;return t})();function _e(t){return t==null||(typeof t=="string"||Array.isArray(t))&&t.length===0}function $r(t){return t!=null&&typeof t.length=="number"}var Wr=new Me("NgValidators"),zr=new Me("NgAsyncValidators"),ms=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,le=class{static min(e){return gs(e)}static max(e){return ys(e)}static required(e){return vs(e)}static requiredTrue(e){return _s(e)}static email(e){return bs(e)}static minLength(e){return ws(e)}static maxLength(e){return Cs(e)}static pattern(e){return Ds(e)}static nullValidator(e){return qr(e)}static compose(e){return ei(e)}static composeAsync(e){return ni(e)}};function gs(t){return e=>{if(_e(e.value)||_e(t))return null;let n=parseFloat(e.value);return!isNaN(n)&&n<t?{min:{min:t,actual:e.value}}:null}}function ys(t){return e=>{if(_e(e.value)||_e(t))return null;let n=parseFloat(e.value);return!isNaN(n)&&n>t?{max:{max:t,actual:e.value}}:null}}function vs(t){return _e(t.value)?{required:!0}:null}function _s(t){return t.value===!0?null:{required:!0}}function bs(t){return _e(t.value)||ms.test(t.value)?null:{email:!0}}function ws(t){return e=>_e(e.value)||!$r(e.value)?null:e.value.length<t?{minlength:{requiredLength:t,actualLength:e.value.length}}:null}function Cs(t){return e=>$r(e.value)&&e.value.length>t?{maxlength:{requiredLength:t,actualLength:e.value.length}}:null}function Ds(t){if(!t)return qr;let e,n;return typeof t=="string"?(n="",t.charAt(0)!=="^"&&(n+="^"),n+=t,t.charAt(t.length-1)!=="$"&&(n+="$"),e=new RegExp(n)):(n=t.toString(),e=t),r=>{if(_e(r.value))return null;let i=r.value;return e.test(i)?null:{pattern:{requiredPattern:n,actualValue:i}}}}function qr(t){return null}function Yr(t){return t!=null}function Xr(t){return Sr(t)?Mr(t):t}function Qr(t){let e={};return t.forEach(n=>{e=n!=null?O(O({},e),n):e}),Object.keys(e).length===0?null:e}function Jr(t,e){return e.map(n=>n(t))}function Es(t){return!t.validate}function Zr(t){return t.map(e=>Es(e)?e:n=>e.validate(n))}function ei(t){if(!t)return null;let e=t.filter(Yr);return e.length==0?null:function(n){return Qr(Jr(n,e))}}function ti(t){return t!=null?ei(Zr(t)):null}function ni(t){if(!t)return null;let e=t.filter(Yr);return e.length==0?null:function(n){let r=Jr(n,e).map(Xr);return xr(r).pipe(Vr(Qr))}}function ri(t){return t!=null?ni(Zr(t)):null}function Nr(t,e){return t===null?[e]:Array.isArray(t)?[...t,e]:[t,e]}function ii(t){return t._rawValidators}function si(t){return t._rawAsyncValidators}function Dn(t){return t?Array.isArray(t)?t:[t]:[]}function Ot(t,e){return Array.isArray(t)?t.includes(e):t===e}function Rr(t,e){let n=Dn(e);return Dn(t).forEach(i=>{Ot(n,i)||n.push(i)}),n}function Br(t,e){return Dn(e).filter(n=>!Ot(t,n))}var Pt=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=ti(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=ri(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,n){return this.control?this.control.hasError(e,n):!1}getError(e,n){return this.control?this.control.getError(e,n):null}},He=class extends Pt{get formDirective(){return null}get path(){return null}},ot=class extends Pt{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},Tt=class{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}},As={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},za=K(O({},As),{"[class.ng-submitted]":"isSubmitted"}),oi=(()=>{let e=class e extends Tt{constructor(r){super(r)}};e.\u0275fac=function(i){return new(i||e)(U(ot,2))},e.\u0275dir=ie({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,s){i&2&&bn("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)},features:[ge]});let t=e;return t})(),ai=(()=>{let e=class e extends Tt{constructor(r){super(r)}};e.\u0275fac=function(i){return new(i||e)(U(He,10))},e.\u0275dir=ie({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,s){i&2&&bn("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)("ng-submitted",s.isSubmitted)},features:[ge]});let t=e;return t})();var it="VALID",Ft="INVALID",Ue="PENDING",st="DISABLED";function li(t){return(Gt(t)?t.validators:t)||null}function Ms(t){return Array.isArray(t)?ti(t):t||null}function ui(t,e){return(Gt(e)?e.asyncValidators:t)||null}function Vs(t){return Array.isArray(t)?ri(t):t||null}function Gt(t){return t!=null&&!Array.isArray(t)&&typeof t=="object"}function xs(t,e,n){let r=t.controls;if(!(e?Object.keys(r):r).length)throw new At(1e3,"");if(!r[n])throw new At(1001,"")}function Ss(t,e,n){t._forEachChild((r,i)=>{if(n[i]===void 0)throw new At(1002,"")})}var kt=class{constructor(e,n){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(n)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===it}get invalid(){return this.status===Ft}get pending(){return this.status==Ue}get disabled(){return this.status===st}get enabled(){return this.status!==st}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(Rr(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(Rr(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(Br(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(Br(e,this._rawAsyncValidators))}hasValidator(e){return Ot(this._rawValidators,e)}hasAsyncValidator(e){return Ot(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(n=>{n.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(n=>{n.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=Ue,e.emitEvent!==!1&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=st,this.errors=null,this._forEachChild(r=>{r.disable(K(O({},e),{onlySelf:!0}))}),this._updateValue(),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(K(O({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=it,this._forEachChild(r=>{r.enable(K(O({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(K(O({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===it||this.status===Ue)&&this._runAsyncValidator(e.emitEvent)),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(n=>n._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?st:it}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=Ue,this._hasOwnPendingAsyncValidator=!0;let n=Xr(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,n={}){this.errors=e,this._updateControlsErrors(n.emitEvent!==!1)}get(e){let n=e;return n==null||(Array.isArray(n)||(n=n.split(".")),n.length===0)?null:n.reduce((r,i)=>r&&r._find(i),this)}getError(e,n){let r=n?this.get(n):this;return r&&r.errors?r.errors[e]:null}hasError(e,n){return!!this.getError(e,n)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new Ve,this.statusChanges=new Ve}_calculateStatus(){return this._allControlsDisabled()?st:this.errors?Ft:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Ue)?Ue:this._anyControlsHaveStatus(Ft)?Ft:it}_anyControlsHaveStatus(e){return this._anyControls(n=>n.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Gt(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let n=this._parent&&this._parent.dirty;return!e&&!!n&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=Ms(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=Vs(this._rawAsyncValidators)}},Nt=class extends kt{constructor(e,n,r){super(li(n),ui(r,n)),this.controls=e,this._initObservables(),this._setUpdateStrategy(n),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,n){return this.controls[e]?this.controls[e]:(this.controls[e]=n,n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange),n)}addControl(e,n,r={}){this.registerControl(e,n),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,n={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}setControl(e,n,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],n&&this.registerControl(e,n),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,n={}){Ss(this,!0,e),Object.keys(e).forEach(r=>{xs(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}patchValue(e,n={}){e!=null&&(Object.keys(e).forEach(r=>{let i=this.controls[r];i&&i.patchValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}reset(e={},n={}){this._forEachChild((r,i)=>{r.reset(e?e[i]:null,{onlySelf:!0,emitEvent:n.emitEvent})}),this._updatePristine(n),this._updateTouched(n),this.updateValueAndValidity(n)}getRawValue(){return this._reduceChildren({},(e,n,r)=>(e[r]=n.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(n,r)=>r._syncPendingControls()?!0:n);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(n=>{let r=this.controls[n];r&&e(r,n)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[n,r]of Object.entries(this.controls))if(this.contains(n)&&e(r))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(n,r,i)=>((r.enabled||this.disabled)&&(n[i]=r.value),n))}_reduceChildren(e,n){let r=e;return this._forEachChild((i,s)=>{r=n(r,i,s)}),r}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var ci=new Me("CallSetDisabledState",{providedIn:"root",factory:()=>An}),An="always";function Is(t,e){return[...e.path,t]}function Kr(t,e,n=An){Mn(t,e),e.valueAccessor.writeValue(t.value),(t.disabled||n==="always")&&e.valueAccessor.setDisabledState?.(t.disabled),Os(t,e),Ts(t,e),Ps(t,e),Fs(t,e)}function jr(t,e,n=!0){let r=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(r),e.valueAccessor.registerOnTouched(r)),Bt(t,e),t&&(e._invokeOnDestroyCallbacks(),t._registerOnCollectionChange(()=>{}))}function Rt(t,e){t.forEach(n=>{n.registerOnValidatorChange&&n.registerOnValidatorChange(e)})}function Fs(t,e){if(e.valueAccessor.setDisabledState){let n=r=>{e.valueAccessor.setDisabledState(r)};t.registerOnDisabledChange(n),e._registerOnDestroy(()=>{t._unregisterOnDisabledChange(n)})}}function Mn(t,e){let n=ii(t);e.validator!==null?t.setValidators(Nr(n,e.validator)):typeof n=="function"&&t.setValidators([n]);let r=si(t);e.asyncValidator!==null?t.setAsyncValidators(Nr(r,e.asyncValidator)):typeof r=="function"&&t.setAsyncValidators([r]);let i=()=>t.updateValueAndValidity();Rt(e._rawValidators,i),Rt(e._rawAsyncValidators,i)}function Bt(t,e){let n=!1;if(t!==null){if(e.validator!==null){let i=ii(t);if(Array.isArray(i)&&i.length>0){let s=i.filter(o=>o!==e.validator);s.length!==i.length&&(n=!0,t.setValidators(s))}}if(e.asyncValidator!==null){let i=si(t);if(Array.isArray(i)&&i.length>0){let s=i.filter(o=>o!==e.asyncValidator);s.length!==i.length&&(n=!0,t.setAsyncValidators(s))}}}let r=()=>{};return Rt(e._rawValidators,r),Rt(e._rawAsyncValidators,r),n}function Os(t,e){e.valueAccessor.registerOnChange(n=>{t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,t.updateOn==="change"&&di(t,e)})}function Ps(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,t.updateOn==="blur"&&t._pendingChange&&di(t,e),t.updateOn!=="submit"&&t.markAsTouched()})}function di(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function Ts(t,e){let n=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};t.registerOnChange(n),e._registerOnDestroy(()=>{t._unregisterOnChange(n)})}function ks(t,e){t==null,Mn(t,e)}function Ns(t,e){return Bt(t,e)}function Rs(t,e){if(!t.hasOwnProperty("model"))return!1;let n=t.model;return n.isFirstChange()?!0:!Object.is(e,n.currentValue)}function Bs(t){return Object.getPrototypeOf(t.constructor)===Lr}function Ks(t,e){t._syncPendingControls(),e.forEach(n=>{let r=n.control;r.updateOn==="submit"&&r._pendingChange&&(n.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function js(t,e){if(!e)return null;Array.isArray(e);let n,r,i;return e.forEach(s=>{s.constructor===jt?n=s:Bs(s)?r=s:i=s}),i||r||n||null}function Gs(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function Gr(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function Ur(t){return typeof t=="object"&&t!==null&&Object.keys(t).length===2&&"value"in t&&"disabled"in t}var Se=class extends kt{constructor(e=null,n,r){super(li(n),ui(r,n)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(n),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Gt(n)&&(n.nonNullable||n.initialValueIsDefault)&&(Ur(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,n={}){this.value=this._pendingValue=e,this._onChange.length&&n.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,n.emitViewToModelChange!==!1)),this.updateValueAndValidity(n)}patchValue(e,n={}){this.setValue(e,n)}reset(e=this.defaultValue,n={}){this._applyFormState(e),this.markAsPristine(n),this.markAsUntouched(n),this.setValue(this.value,n),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){Gr(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){Gr(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){Ur(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var Us=t=>t instanceof Se;var hi=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=ie({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]});let t=e;return t})(),Hs={provide:En,useExisting:tt(()=>Vn),multi:!0},Vn=(()=>{let e=class e extends Lr{writeValue(r){let i=r??"";this.setProperty("value",i)}registerOnChange(r){this.onChange=i=>{r(i==""?null:parseFloat(i))}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=yn(e)))(s||e)}})(),e.\u0275dir=ie({type:e,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(i,s){i&1&&ne("input",function(a){return s.onChange(a.target.value)})("blur",function(){return s.onTouched()})},features:[rt([Hs]),ge]});let t=e;return t})();var Ls=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Vt({type:e}),e.\u0275inj=Mt({});let t=e;return t})();var fi=new Me("NgModelWithFormControlWarning");var $s={provide:He,useExisting:tt(()=>xn)},xn=(()=>{let e=class e extends He{constructor(r,i,s){super(),this.callSetDisabledState=s,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new Ve,this._setValidators(r),this._setAsyncValidators(i)}ngOnChanges(r){this._checkFormPresent(),r.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(Bt(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(r){let i=this.form.get(r.path);return Kr(i,r,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(r),i}getControl(r){return this.form.get(r.path)}removeControl(r){jr(r.control||null,r,!1),Gs(this.directives,r)}addFormGroup(r){this._setUpFormContainer(r)}removeFormGroup(r){this._cleanUpFormContainer(r)}getFormGroup(r){return this.form.get(r.path)}addFormArray(r){this._setUpFormContainer(r)}removeFormArray(r){this._cleanUpFormContainer(r)}getFormArray(r){return this.form.get(r.path)}updateModel(r,i){this.form.get(r.path).setValue(i)}onSubmit(r){return this.submitted=!0,Ks(this.form,this.directives),this.ngSubmit.emit(r),r?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(r=void 0){this.form.reset(r),this.submitted=!1}_updateDomValue(){this.directives.forEach(r=>{let i=r.control,s=this.form.get(r.path);i!==s&&(jr(i||null,r),Us(s)&&(Kr(s,r,this.callSetDisabledState),r.control=s))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(r){let i=this.form.get(r.path);ks(i,r),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(r){if(this.form){let i=this.form.get(r.path);i&&Ns(i,r)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){Mn(this.form,this),this._oldForm&&Bt(this._oldForm,this)}_checkFormPresent(){this.form}};e.\u0275fac=function(i){return new(i||e)(U(Wr,10),U(zr,10),U(ci,8))},e.\u0275dir=ie({type:e,selectors:[["","formGroup",""]],hostBindings:function(i,s){i&1&&ne("submit",function(a){return s.onSubmit(a)})("reset",function(){return s.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[rt([$s]),ge,gn]});let t=e;return t})();var Ws={provide:ot,useExisting:tt(()=>Sn)},Sn=(()=>{let e=class e extends ot{set isDisabled(r){}constructor(r,i,s,o,a){super(),this._ngModelWarningConfig=a,this._added=!1,this.name=null,this.update=new Ve,this._ngModelWarningSent=!1,this._parent=r,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=js(this,o)}ngOnChanges(r){this._added||this._setUpControl(),Rs(r,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(r){this.viewModel=r,this.update.emit(r)}get path(){return Is(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}};e._ngModelWarningSentOnce=!1,e.\u0275fac=function(i){return new(i||e)(U(He,13),U(Wr,10),U(zr,10),U(En,10),U(fi,8))},e.\u0275dir=ie({type:e,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[rt([Ws]),ge,gn]});let t=e;return t})();var zs=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Vt({type:e}),e.\u0275inj=Mt({imports:[Ls]});let t=e;return t})();var pi=(()=>{let e=class e{static withConfig(r){return{ngModule:e,providers:[{provide:fi,useValue:r.warnOnNgModelWithFormControl??"always"},{provide:ci,useValue:r.callSetDisabledState??An}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Vt({type:e}),e.\u0275inj=Mt({imports:[zs]});let t=e;return t})();function Xs(t,e){if(t&1&&(P(0,"span",9),B(1),F()),t&2){let n=xe();X(1),ve(n.errorMessage)}}var mi=(()=>{let e=class e{constructor(){this.memberFormValues=new Nt({id:new Se("",[le.required]),firstName:new Se("",[le.required]),secondName:new Se("",[le.required]),finalName:new Se("",[le.required]),age:new Se("",[le.required,le.min(0)])}),this.memberAdded=new Ve,this.errorMessage="",this.onSubmit=()=>{console.log(this.memberFormValues.value),this.memberAdded.emit(this.memberFormValues.value)}}ngOnInit(){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Ke({type:e,selectors:[["app-form-members"]],inputs:{errorMessage:"errorMessage"},outputs:{memberAdded:"memberAdded"},standalone:!0,features:[je],decls:24,vars:3,consts:[[3,"formGroup","ngSubmit"],[1,"column-flex"],["type","number","formControlName","id"],["class","error",4,"ngIf"],["type","text","formControlName","firstName"],["type","text","formControlName","secondName"],["type","text","formControlName","finalName"],["type","number","formControlName","age"],["type","submit",3,"disabled"],[1,"error"]],template:function(i,s){i&1&&(P(0,"form",0),ne("ngSubmit",function(){return s.onSubmit()}),P(1,"div",1)(2,"label"),B(3,"ID:"),F(),se(4,"input",2),nt(5,Xs,2,1,"span",3),F(),P(6,"div",1)(7,"label"),B(8,"First Name:"),F(),se(9,"input",4),F(),P(10,"div",1)(11,"label"),B(12,"Second Name:"),F(),se(13,"input",5),F(),P(14,"div",1)(15,"label"),B(16,"Final Name: "),F(),se(17,"input",6),F(),P(18,"div",1)(19,"label"),B(20,"Age:"),F(),se(21,"input",7),F(),P(22,"button",8),B(23," Add Member "),F()()),i&2&&(ye("formGroup",s.memberFormValues),X(5),ye("ngIf",s.errorMessage),X(17),ye("disabled",!s.memberFormValues.valid))},dependencies:[Ge,It,pi,hi,jt,Vn,oi,ai,xn,Sn],styles:["form[_ngcontent-%COMP%]{margin:auto;display:flex;flex-direction:column;row-gap:24px}label[_ngcontent-%COMP%]{margin-bottom:10px}input[_ngcontent-%COMP%]{padding:5px;border:1px solid #ddd;border-radius:3px;margin-top:5px;height:22px}button[_ngcontent-%COMP%]{padding:10px;background-color:#4caf50;color:#fff;border:none;cursor:pointer;border-radius:5px;font-size:16px}button[_ngcontent-%COMP%]:hover{background-color:#45a049}.column-flex[_ngcontent-%COMP%]{display:flex;flex-direction:column}.error[_ngcontent-%COMP%]{color:red;font-size:12px}"]});let t=e;return t})();var k=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,j=Object.keys,$=Array.isArray;typeof Promise<"u"&&!k.Promise&&(k.Promise=Promise);function z(t,e){return typeof e!="object"||j(e).forEach(function(n){t[n]=e[n]}),t}var ht=Object.getPrototypeOf,Qs={}.hasOwnProperty;function J(t,e){return Qs.call(t,e)}function qe(t,e){typeof e=="function"&&(e=e(ht(t))),(typeof Reflect>"u"?j:Reflect.ownKeys)(e).forEach(n=>{pe(t,n,e[n])})}var xi=Object.defineProperty;function pe(t,e,n,r){xi(t,e,z(n&&J(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function Xe(t){return{from:function(e){return t.prototype=Object.create(e.prototype),pe(t.prototype,"constructor",t),{extend:qe.bind(null,t.prototype)}}}}var Js=Object.getOwnPropertyDescriptor;function cr(t,e){let n=Js(t,e),r;return n||(r=ht(t))&&cr(r,e)}var Zs=[].slice;function cn(t,e,n){return Zs.call(t,e,n)}function Si(t,e){return e(t)}function at(t){if(!t)throw new Error("Assertion Failed")}function Ii(t){k.setImmediate?setImmediate(t):setTimeout(t,0)}function Fi(t,e){return t.reduce((n,r,i)=>{var s=e(r,i);return s&&(n[s[0]]=s[1]),n},{})}function eo(t,e,n){try{t.apply(null,n)}catch(r){e&&e(r)}}function fe(t,e){if(J(t,e))return t[e];if(!e)return t;if(typeof e!="string"){for(var n=[],r=0,i=e.length;r<i;++r){var s=fe(t,e[r]);n.push(s)}return n}var o=e.indexOf(".");if(o!==-1){var a=t[e.substr(0,o)];return a===void 0?void 0:fe(a,e.substr(o+1))}}function re(t,e,n){if(!(!t||e===void 0)&&!("isFrozen"in Object&&Object.isFrozen(t)))if(typeof e!="string"&&"length"in e){at(typeof n!="string"&&"length"in n);for(var r=0,i=e.length;r<i;++r)re(t,e[r],n[r])}else{var s=e.indexOf(".");if(s!==-1){var o=e.substr(0,s),a=e.substr(s+1);if(a==="")n===void 0?$(t)&&!isNaN(parseInt(o))?t.splice(o,1):delete t[o]:t[o]=n;else{var l=t[o];(!l||!J(t,o))&&(l=t[o]={}),re(l,a,n)}}else n===void 0?$(t)&&!isNaN(parseInt(e))?t.splice(e,1):delete t[e]:t[e]=n}}function to(t,e){typeof e=="string"?re(t,e,void 0):"length"in e&&[].map.call(e,function(n){re(t,n,void 0)})}function Oi(t){var e={};for(var n in t)J(t,n)&&(e[n]=t[n]);return e}var no=[].concat;function Pi(t){return no.apply([],t)}var Ti="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Pi([8,16,32,64].map(t=>["Int","Uint","Float"].map(e=>e+t+"Array")))).filter(t=>k[t]),ro=Ti.map(t=>k[t]);Fi(Ti,t=>[t,!0]);var we=null;function _t(t){we=typeof WeakMap<"u"&&new WeakMap;let e=Nn(t);return we=null,e}function Nn(t){if(!t||typeof t!="object")return t;let e=we&&we.get(t);if(e)return e;if($(t)){e=[],we&&we.set(t,e);for(var n=0,r=t.length;n<r;++n)e.push(Nn(t[n]))}else if(ro.indexOf(t.constructor)>=0)e=t;else{let s=ht(t);e=s===Object.prototype?{}:Object.create(s),we&&we.set(t,e);for(var i in t)J(t,i)&&(e[i]=Nn(t[i]))}return e}var{toString:io}={};function Rn(t){return io.call(t).slice(8,-1)}var Bn=typeof Symbol<"u"?Symbol.iterator:"@@iterator",so=typeof Bn=="symbol"?function(t){var e;return t!=null&&(e=t[Bn])&&e.apply(t)}:function(){return null},We={};function de(t){var e,n,r,i;if(arguments.length===1){if($(t))return t.slice();if(this===We&&typeof t=="string")return[t];if(i=so(t)){for(n=[];r=i.next(),!r.done;)n.push(r.value);return n}if(t==null)return[t];if(e=t.length,typeof e=="number"){for(n=new Array(e);e--;)n[e]=t[e];return n}return[t]}for(e=arguments.length,n=new Array(e);e--;)n[e]=arguments[e];return n}var dr=typeof Symbol<"u"?t=>t[Symbol.toStringTag]==="AsyncFunction":()=>!1,ae=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function ki(t,e){ae=t,Ni=e}var Ni=()=>!0,oo=!new Error("").stack;function Ne(){if(oo)try{throw Ne.arguments,new Error}catch(t){return t}return new Error}function Kn(t,e){var n=t.stack;return n?(e=e||0,n.indexOf(t.name)===0&&(e+=(t.name+t.message).split(`
`).length),n.split(`
`).slice(e).filter(Ni).map(r=>`
`+r).join("")):""}var ao=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"],Ri=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],hr=ao.concat(Ri),lo={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Qe(t,e){this._e=Ne(),this.name=t,this.message=e}Xe(Qe).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+Kn(this._e,2))}},toString:function(){return this.name+": "+this.message}});function Bi(t,e){return t+". Errors: "+Object.keys(e).map(n=>e[n].toString()).filter((n,r,i)=>i.indexOf(n)===r).join(`
`)}function Zt(t,e,n,r){this._e=Ne(),this.failures=e,this.failedKeys=r,this.successCount=n,this.message=Bi(t,e)}Xe(Zt).from(Qe);function ut(t,e){this._e=Ne(),this.name="BulkError",this.failures=Object.keys(e).map(n=>e[n]),this.failuresByPos=e,this.message=Bi(t,e)}Xe(ut).from(Qe);var fr=hr.reduce((t,e)=>(t[e]=e+"Error",t),{}),uo=Qe,M=hr.reduce((t,e)=>{var n=e+"Error";function r(i,s){this._e=Ne(),this.name=n,i?typeof i=="string"?(this.message=`${i}${s?`
 `+s:""}`,this.inner=s||null):typeof i=="object"&&(this.message=`${i.name} ${i.message}`,this.inner=i):(this.message=lo[e]||n,this.inner=null)}return Xe(r).from(uo),t[e]=r,t},{});M.Syntax=SyntaxError;M.Type=TypeError;M.Range=RangeError;var gi=Ri.reduce((t,e)=>(t[e+"Error"]=M[e],t),{});function co(t,e){if(!t||t instanceof Qe||t instanceof TypeError||t instanceof SyntaxError||!t.name||!gi[t.name])return t;var n=new gi[t.name](e||t.message,t);return"stack"in t&&pe(n,"stack",{get:function(){return this.inner.stack}}),n}var dn=hr.reduce((t,e)=>(["Syntax","Type","Range"].indexOf(e)===-1&&(t[e+"Error"]=M[e]),t),{});dn.ModifyError=Zt;dn.DexieError=Qe;dn.BulkError=ut;function T(){}function bt(t){return t}function ho(t,e){return t==null||t===bt?e:function(n){return e(t(n))}}function Te(t,e){return function(){t.apply(this,arguments),e.apply(this,arguments)}}function fo(t,e){return t===T?e:function(){var n=t.apply(this,arguments);n!==void 0&&(arguments[0]=n);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var s=e.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?Te(r,this.onsuccess):r),i&&(this.onerror=this.onerror?Te(i,this.onerror):i),s!==void 0?s:n}}function po(t,e){return t===T?e:function(){t.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,e.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?Te(n,this.onsuccess):n),r&&(this.onerror=this.onerror?Te(r,this.onerror):r)}}function mo(t,e){return t===T?e:function(n){var r=t.apply(this,arguments);z(n,r);var i=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var o=e.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?Te(i,this.onsuccess):i),s&&(this.onerror=this.onerror?Te(s,this.onerror):s),r===void 0?o===void 0?void 0:o:z(r,o)}}function go(t,e){return t===T?e:function(){return e.apply(this,arguments)===!1?!1:t.apply(this,arguments)}}function pr(t,e){return t===T?e:function(){var n=t.apply(this,arguments);if(n&&typeof n.then=="function"){for(var r=this,i=arguments.length,s=new Array(i);i--;)s[i]=arguments[i];return n.then(function(){return e.apply(r,s)})}return e.apply(this,arguments)}}var ft={},yo=100,vo=20,Ki=100,[jn,en,Gn]=typeof Promise>"u"?[]:(()=>{let t=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[t,ht(t),t];let e=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[e,ht(e),t]})(),ji=en&&en.then,zt=jn&&jn.constructor,mr=!!Gn,Un=!1,_o=Gn?()=>{Gn.then(Ut)}:k.setImmediate?setImmediate.bind(null,Ut):k.MutationObserver?()=>{var t=document.createElement("div");new MutationObserver(()=>{Ut(),t=null}).observe(t,{attributes:!0}),t.setAttribute("i","1")}:()=>{setTimeout(Ut,0)},pt=function(t,e){lt.push([t,e]),tn&&(_o(),tn=!1)},Hn=!0,tn=!0,Oe=[],qt=[],Ln=null,$n=bt,ze={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:_i,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(t=>{try{_i(t[0],t[1])}catch{}})}},A=ze,lt=[],Pe=0,Yt=[];function w(t){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=T,this._lib=!1;var e=this._PSD=A;if(ae&&(this._stackHolder=Ne(),this._prev=null,this._numPrev=0),typeof t!="function"){if(t!==ft)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&zn(this,this._value);return}this._state=null,this._value=null,++e.ref,Ui(this,t)}var Wn={get:function(){var t=A,e=nn;function n(r,i){var s=!t.global&&(t!==A||e!==nn);let o=s&&!me();var a=new w((l,u)=>{gr(this,new Gi(sn(r,t,s,o),sn(i,t,s,o),l,u,t))});return ae&&$i(a,this),a}return n.prototype=ft,n},set:function(t){pe(this,"then",t&&t.prototype===ft?Wn:{get:function(){return t},set:Wn.set})}};qe(w.prototype,{then:Wn,_then:function(t,e){gr(this,new Gi(null,null,t,e,A))},catch:function(t){if(arguments.length===1)return this.then(null,t);var e=arguments[0],n=arguments[1];return typeof e=="function"?this.then(null,r=>r instanceof e?n(r):Xt(r)):this.then(null,r=>r&&r.name===e?n(r):Xt(r))},finally:function(t){return this.then(e=>(t(),e),e=>(t(),Xt(e)))},stack:{get:function(){if(this._stack)return this._stack;try{Un=!0;var t=Li(this,[],vo),e=t.join(`
From previous: `);return this._state!==null&&(this._stack=e),e}finally{Un=!1}}},timeout:function(t,e){return t<1/0?new w((n,r)=>{var i=setTimeout(()=>r(new M.Timeout(e)),t);this.then(n,r).finally(clearTimeout.bind(null,i))}):this}});typeof Symbol<"u"&&Symbol.toStringTag&&pe(w.prototype,Symbol.toStringTag,"Dexie.Promise");ze.env=Wi();function Gi(t,e,n,r,i){this.onFulfilled=typeof t=="function"?t:null,this.onRejected=typeof e=="function"?e:null,this.resolve=n,this.reject=r,this.psd=i}qe(w,{all:function(){var t=de.apply(null,arguments).map(rn);return new w(function(e,n){t.length===0&&e([]);var r=t.length;t.forEach((i,s)=>w.resolve(i).then(o=>{t[s]=o,--r||e(t)},n))})},resolve:t=>{if(t instanceof w)return t;if(t&&typeof t.then=="function")return new w((n,r)=>{t.then(n,r)});var e=new w(ft,!0,t);return $i(e,Ln),e},reject:Xt,race:function(){var t=de.apply(null,arguments).map(rn);return new w((e,n)=>{t.map(r=>w.resolve(r).then(e,n))})},PSD:{get:()=>A,set:t=>A=t},totalEchoes:{get:()=>nn},newPSD:De,usePSD:Ze,scheduler:{get:()=>pt,set:t=>{pt=t}},rejectionMapper:{get:()=>$n,set:t=>{$n=t}},follow:(t,e)=>new w((n,r)=>De((i,s)=>{var o=A;o.unhandleds=[],o.onunhandled=s,o.finalize=Te(function(){wo(()=>{this.unhandleds.length===0?i():s(this.unhandleds[0])})},o.finalize),t()},e,n,r))});zt&&(zt.allSettled&&pe(w,"allSettled",function(){let t=de.apply(null,arguments).map(rn);return new w(e=>{t.length===0&&e([]);let n=t.length,r=new Array(n);t.forEach((i,s)=>w.resolve(i).then(o=>r[s]={status:"fulfilled",value:o},o=>r[s]={status:"rejected",reason:o}).then(()=>--n||e(r)))})}),zt.any&&typeof AggregateError<"u"&&pe(w,"any",function(){let t=de.apply(null,arguments).map(rn);return new w((e,n)=>{t.length===0&&n(new AggregateError([]));let r=t.length,i=new Array(r);t.forEach((s,o)=>w.resolve(s).then(a=>e(a),a=>{i[o]=a,--r||n(new AggregateError(i))}))})}));function Ui(t,e){try{e(n=>{if(t._state===null){if(n===t)throw new TypeError("A promise cannot be resolved with itself.");var r=t._lib&&wt();n&&typeof n.then=="function"?Ui(t,(i,s)=>{n instanceof w?n._then(i,s):n.then(i,s)}):(t._state=!0,t._value=n,Hi(t)),r&&Ct()}},zn.bind(null,t))}catch(n){zn(t,n)}}function zn(t,e){if(qt.push(e),t._state===null){var n=t._lib&&wt();e=$n(e),t._state=!1,t._value=e,ae&&e!==null&&typeof e=="object"&&!e._promise&&eo(()=>{var r=cr(e,"stack");e._promise=t,pe(e,"stack",{get:()=>Un?r&&(r.get?r.get.apply(e):r.value):t.stack})}),Co(t),Hi(t),n&&Ct()}}function Hi(t){var e=t._listeners;t._listeners=[];for(var n=0,r=e.length;n<r;++n)gr(t,e[n]);var i=t._PSD;--i.ref||i.finalize(),Pe===0&&(++Pe,pt(()=>{--Pe===0&&yr()},[]))}function gr(t,e){if(t._state===null){t._listeners.push(e);return}var n=t._state?e.onFulfilled:e.onRejected;if(n===null)return(t._state?e.resolve:e.reject)(t._value);++e.psd.ref,++Pe,pt(bo,[n,t,e])}function bo(t,e,n){try{Ln=e;var r,i=e._value;e._state?r=t(i):(qt.length&&(qt=[]),r=t(i),qt.indexOf(i)===-1&&Do(e)),n.resolve(r)}catch(s){n.reject(s)}finally{Ln=null,--Pe===0&&yr(),--n.psd.ref||n.psd.finalize()}}function Li(t,e,n){if(e.length===n)return e;var r="";if(t._state===!1){var i=t._value,s,o;i!=null?(s=i.name||"Error",o=i.message||i,r=Kn(i,0)):(s=i,o=""),e.push(s+(o?": "+o:"")+r)}return ae&&(r=Kn(t._stackHolder,2),r&&e.indexOf(r)===-1&&e.push(r),t._prev&&Li(t._prev,e,n)),e}function $i(t,e){var n=e?e._numPrev+1:0;n<yo&&(t._prev=e,t._numPrev=n)}function Ut(){wt()&&Ct()}function wt(){var t=Hn;return Hn=!1,tn=!1,t}function Ct(){var t,e,n;do for(;lt.length>0;)for(t=lt,lt=[],n=t.length,e=0;e<n;++e){var r=t[e];r[0].apply(null,r[1])}while(lt.length>0);Hn=!0,tn=!0}function yr(){var t=Oe;Oe=[],t.forEach(r=>{r._PSD.onunhandled.call(null,r._value,r)});for(var e=Yt.slice(0),n=e.length;n;)e[--n]()}function wo(t){function e(){t(),Yt.splice(Yt.indexOf(e),1)}Yt.push(e),++Pe,pt(()=>{--Pe===0&&yr()},[])}function Co(t){Oe.some(e=>e._value===t._value)||Oe.push(t)}function Do(t){for(var e=Oe.length;e;)if(Oe[--e]._value===t._value){Oe.splice(e,1);return}}function Xt(t){return new w(ft,!1,t)}function R(t,e){var n=A;return function(){var r=wt(),i=A;try{return Ee(n,!0),t.apply(this,arguments)}catch(s){e&&e(s)}finally{Ee(i,!1),r&&Ct()}}}var L={awaits:0,echoes:0,id:0},Eo=0,Qt=[],In=0,nn=0,Ao=0;function De(t,e,n,r){var i=A,s=Object.create(i);s.parent=i,s.ref=0,s.global=!1,s.id=++Ao;var o=ze.env;s.env=mr?{Promise:w,PromiseProp:{value:w,configurable:!0,writable:!0},all:w.all,race:w.race,allSettled:w.allSettled,any:w.any,resolve:w.resolve,reject:w.reject,nthen:yi(o.nthen,s),gthen:yi(o.gthen,s)}:{},e&&z(s,e),++i.ref,s.finalize=function(){--this.parent.ref||this.parent.finalize()};var a=Ze(s,t,n,r);return s.ref===0&&s.finalize(),a}function Je(){return L.id||(L.id=++Eo),++L.awaits,L.echoes+=Ki,L.id}function me(){return L.awaits?(--L.awaits===0&&(L.id=0),L.echoes=L.awaits*Ki,!0):!1}(""+ji).indexOf("[native code]")===-1&&(Je=me=T);function rn(t){return L.echoes&&t&&t.constructor===zt?(Je(),t.then(e=>(me(),e),e=>(me(),G(e)))):t}function Mo(t){++nn,(!L.echoes||--L.echoes===0)&&(L.echoes=L.id=0),Qt.push(A),Ee(t,!0)}function Vo(){var t=Qt[Qt.length-1];Qt.pop(),Ee(t,!1)}function Ee(t,e){var n=A;if((e?L.echoes&&(!In++||t!==A):In&&(!--In||t!==A))&&zi(e?Mo.bind(null,t):Vo),t!==A&&(A=t,n===ze&&(ze.env=Wi()),mr)){var r=ze.env.Promise,i=t.env;en.then=i.nthen,r.prototype.then=i.gthen,(n.global||t.global)&&(Object.defineProperty(k,"Promise",i.PromiseProp),r.all=i.all,r.race=i.race,r.resolve=i.resolve,r.reject=i.reject,i.allSettled&&(r.allSettled=i.allSettled),i.any&&(r.any=i.any))}}function Wi(){var t=k.Promise;return mr?{Promise:t,PromiseProp:Object.getOwnPropertyDescriptor(k,"Promise"),all:t.all,race:t.race,allSettled:t.allSettled,any:t.any,resolve:t.resolve,reject:t.reject,nthen:en.then,gthen:t.prototype.then}:{}}function Ze(t,e,n,r,i){var s=A;try{return Ee(t,!0),e(n,r,i)}finally{Ee(s,!1)}}function zi(t){ji.call(jn,t)}function sn(t,e,n,r){return typeof t!="function"?t:function(){var i=A;n&&Je(),Ee(e,!0);try{return t.apply(this,arguments)}finally{Ee(i,!1),r&&zi(me)}}}function yi(t,e){return function(n,r){return t.call(this,sn(n,e),sn(r,e))}}var vi="unhandledrejection";function _i(t,e){var n;try{n=e.onuncatched(t)}catch{}if(n!==!1)try{var r,i={promise:e,reason:t};if(k.document&&document.createEvent?(r=document.createEvent("Event"),r.initEvent(vi,!0,!0),z(r,i)):k.CustomEvent&&(r=new CustomEvent(vi,{detail:i}),z(r,i)),r&&k.dispatchEvent&&(dispatchEvent(r),!k.PromiseRejectionEvent&&k.onunhandledrejection))try{k.onunhandledrejection(r)}catch{}ae&&r&&!r.defaultPrevented&&console.warn(`Unhandled rejection: ${t.stack||t}`)}catch{}}var G=w.reject;function qn(t,e,n,r){if(!t.idbdb||!t._state.openComplete&&!A.letThrough&&!t._vip){if(t._state.openComplete)return G(new M.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._options.autoOpen)return G(new M.DatabaseClosed);t.open().catch(T)}return t._state.dbReadyPromise.then(()=>qn(t,e,n,r))}else{var i=t._createTransaction(e,n,t._dbSchema);try{i.create(),t._state.PR1398_maxLoop=3}catch(s){return s.name===fr.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(()=>qn(t,e,n,r))):G(s)}return i._promise(e,(s,o)=>De(()=>(A.trans=i,r(s,o,i)))).then(s=>i._completion.then(()=>s))}}var bi="3.2.4",Fe=String.fromCharCode(65535),Yn=-1/0,ue="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",qi="String expected.",ct=[],hn=typeof navigator<"u"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),xo=hn,So=hn,Yi=t=>!/(dexie\.js|dexie\.min\.js)/.test(t),fn="__dbnames",Fn="readonly",On="readwrite";function ke(t,e){return t?e?function(){return t.apply(this,arguments)&&e.apply(this,arguments)}:t:e}var Xi={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Ht(t){return typeof t=="string"&&!/\./.test(t)?e=>(e[t]===void 0&&t in e&&(e=_t(e),delete e[t]),e):e=>e}var Xn=class{_trans(e,n,r){let i=this._tx||A.trans,s=this.name;function o(l,u,d){if(!d.schema[s])throw new M.NotFound("Table "+s+" not part of transaction");return n(d.idbtrans,d)}let a=wt();try{return i&&i.db===this.db?i===A.trans?i._promise(e,o,r):De(()=>i._promise(e,o,r),{trans:i,transless:A.transless||A}):qn(this.db,e,[this.name],o)}finally{a&&Ct()}}get(e,n){return e&&e.constructor===Object?this.where(e).first(n):this._trans("readonly",r=>this.core.get({trans:r,key:e}).then(i=>this.hook.reading.fire(i))).then(n)}where(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if($(e))return new this.db.WhereClause(this,`[${e.join("+")}]`);let n=j(e);if(n.length===1)return this.where(n[0]).equals(e[n[0]]);let r=this.schema.indexes.concat(this.schema.primKey).filter(u=>u.compound&&n.every(d=>u.keyPath.indexOf(d)>=0)&&u.keyPath.every(d=>n.indexOf(d)>=0))[0];if(r&&this.db._maxKey!==Fe)return this.where(r.name).equals(r.keyPath.map(u=>e[u]));!r&&ae&&console.warn(`The query ${JSON.stringify(e)} on ${this.name} would benefit of a compound index [${n.join("+")}]`);let{idxByName:i}=this.schema,s=this.db._deps.indexedDB;function o(u,d){try{return s.cmp(u,d)===0}catch{return!1}}let[a,l]=n.reduce(([u,d],f)=>{let c=i[f],h=e[f];return[u||c,u||!c?ke(d,c&&c.multi?y=>{let m=fe(y,f);return $(m)&&m.some(v=>o(h,v))}:y=>o(h,fe(y,f))):d]},[null,null]);return a?this.where(a.name).equals(e[a.keyPath]).filter(l):r?this.filter(l):this.where(n).equals("")}filter(e){return this.toCollection().and(e)}count(e){return this.toCollection().count(e)}offset(e){return this.toCollection().offset(e)}limit(e){return this.toCollection().limit(e)}each(e){return this.toCollection().each(e)}toArray(e){return this.toCollection().toArray(e)}toCollection(){return new this.db.Collection(new this.db.WhereClause(this))}orderBy(e){return new this.db.Collection(new this.db.WhereClause(this,$(e)?`[${e.join("+")}]`:e))}reverse(){return this.toCollection().reverse()}mapToClass(e){this.schema.mappedClass=e;let n=r=>{if(!r)return r;let i=Object.create(e.prototype);for(var s in r)if(J(r,s))try{i[s]=r[s]}catch{}return i};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=n,this.hook("reading",n),e}defineClass(){function e(n){z(this,n)}return this.mapToClass(e)}add(e,n){let{auto:r,keyPath:i}=this.schema.primKey,s=e;return i&&r&&(s=Ht(i)(e)),this._trans("readwrite",o=>this.core.mutate({trans:o,type:"add",keys:n!=null?[n]:null,values:[s]})).then(o=>o.numFailures?w.reject(o.failures[0]):o.lastResult).then(o=>{if(i)try{re(e,i,o)}catch{}return o})}update(e,n){if(typeof e=="object"&&!$(e)){let r=fe(e,this.schema.primKey.keyPath);if(r===void 0)return G(new M.InvalidArgument("Given object does not contain its primary key"));try{typeof n!="function"?j(n).forEach(i=>{re(e,i,n[i])}):n(e,{value:e,primKey:r})}catch{}return this.where(":id").equals(r).modify(n)}else return this.where(":id").equals(e).modify(n)}put(e,n){let{auto:r,keyPath:i}=this.schema.primKey,s=e;return i&&r&&(s=Ht(i)(e)),this._trans("readwrite",o=>this.core.mutate({trans:o,type:"put",values:[s],keys:n!=null?[n]:null})).then(o=>o.numFailures?w.reject(o.failures[0]):o.lastResult).then(o=>{if(i)try{re(e,i,o)}catch{}return o})}delete(e){return this._trans("readwrite",n=>this.core.mutate({trans:n,type:"delete",keys:[e]})).then(n=>n.numFailures?w.reject(n.failures[0]):void 0)}clear(){return this._trans("readwrite",e=>this.core.mutate({trans:e,type:"deleteRange",range:Xi})).then(e=>e.numFailures?w.reject(e.failures[0]):void 0)}bulkGet(e){return this._trans("readonly",n=>this.core.getMany({keys:e,trans:n}).then(r=>r.map(i=>this.hook.reading.fire(i))))}bulkAdd(e,n,r){let i=Array.isArray(n)?n:void 0;r=r||(i?void 0:n);let s=r?r.allKeys:void 0;return this._trans("readwrite",o=>{let{auto:a,keyPath:l}=this.schema.primKey;if(l&&i)throw new M.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new M.InvalidArgument("Arguments objects and keys must have the same length");let u=e.length,d=l&&a?e.map(Ht(l)):e;return this.core.mutate({trans:o,type:"add",keys:i,values:d,wantResults:s}).then(({numFailures:f,results:c,lastResult:h,failures:y})=>{let m=s?c:h;if(f===0)return m;throw new ut(`${this.name}.bulkAdd(): ${f} of ${u} operations failed`,y)})})}bulkPut(e,n,r){let i=Array.isArray(n)?n:void 0;r=r||(i?void 0:n);let s=r?r.allKeys:void 0;return this._trans("readwrite",o=>{let{auto:a,keyPath:l}=this.schema.primKey;if(l&&i)throw new M.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new M.InvalidArgument("Arguments objects and keys must have the same length");let u=e.length,d=l&&a?e.map(Ht(l)):e;return this.core.mutate({trans:o,type:"put",keys:i,values:d,wantResults:s}).then(({numFailures:f,results:c,lastResult:h,failures:y})=>{let m=s?c:h;if(f===0)return m;throw new ut(`${this.name}.bulkPut(): ${f} of ${u} operations failed`,y)})})}bulkDelete(e){let n=e.length;return this._trans("readwrite",r=>this.core.mutate({trans:r,type:"delete",keys:e})).then(({numFailures:r,lastResult:i,failures:s})=>{if(r===0)return i;throw new ut(`${this.name}.bulkDelete(): ${r} of ${n} operations failed`,s)})}};function Dt(t){var e={},n=function(a,l){if(l){for(var u=arguments.length,d=new Array(u-1);--u;)d[u-1]=arguments[u];return e[a].subscribe.apply(null,d),t}else if(typeof a=="string")return e[a]};n.addEventType=s;for(var r=1,i=arguments.length;r<i;++r)s(arguments[r]);return n;function s(a,l,u){if(typeof a=="object")return o(a);l||(l=go),u||(u=T);var d={subscribers:[],fire:u,subscribe:function(f){d.subscribers.indexOf(f)===-1&&(d.subscribers.push(f),d.fire=l(d.fire,f))},unsubscribe:function(f){d.subscribers=d.subscribers.filter(function(c){return c!==f}),d.fire=d.subscribers.reduce(l,u)}};return e[a]=n[a]=d,d}function o(a){j(a).forEach(function(l){var u=a[l];if($(u))s(l,a[l][0],a[l][1]);else if(u==="asap")var d=s(l,bt,function(){for(var c=arguments.length,h=new Array(c);c--;)h[c]=arguments[c];d.subscribers.forEach(function(y){Ii(function(){y.apply(null,h)})})});else throw new M.InvalidArgument("Invalid event config")})}}function Et(t,e){return Xe(e).from({prototype:t}),e}function Io(t){return Et(Xn.prototype,function(n,r,i){this.db=t,this._tx=i,this.name=n,this.schema=r,this.hook=t._allTables[n]?t._allTables[n].hook:Dt(null,{creating:[fo,T],reading:[ho,bt],updating:[mo,T],deleting:[po,T]})})}function Le(t,e){return!(t.filter||t.algorithm||t.or)&&(e?t.justLimit:!t.replayFilter)}function Pn(t,e){t.filter=ke(t.filter,e)}function Tn(t,e,n){var r=t.replayFilter;t.replayFilter=r?()=>ke(r(),e()):e,t.justLimit=n&&!r}function Fo(t,e){t.isMatch=ke(t.isMatch,e)}function Jt(t,e){if(t.isPrimKey)return e.primaryKey;let n=e.getIndexByKeyPath(t.index);if(!n)throw new M.Schema("KeyPath "+t.index+" on object store "+e.name+" is not indexed");return n}function wi(t,e,n){let r=Jt(t,e.schema);return e.openCursor({trans:n,values:!t.keysOnly,reverse:t.dir==="prev",unique:!!t.unique,query:{index:r,range:t.range}})}function Lt(t,e,n,r){let i=t.replayFilter?ke(t.filter,t.replayFilter()):t.filter;if(t.or){let s={},o=(a,l,u)=>{if(!i||i(l,u,c=>l.stop(c),c=>l.fail(c))){var d=l.primaryKey,f=""+d;f==="[object ArrayBuffer]"&&(f=""+new Uint8Array(d)),J(s,f)||(s[f]=!0,e(a,l,u))}};return Promise.all([t.or._iterate(o,n),Ci(wi(t,r,n),t.algorithm,o,!t.keysOnly&&t.valueMapper)])}else return Ci(wi(t,r,n),ke(t.algorithm,i),e,!t.keysOnly&&t.valueMapper)}function Ci(t,e,n,r){var i=r?(o,a,l)=>n(r(o),a,l):n,s=R(i);return t.then(o=>{if(o)return o.start(()=>{var a=()=>o.continue();(!e||e(o,l=>a=l,l=>{o.stop(l),a=T},l=>{o.fail(l),a=T}))&&s(o.value,o,l=>a=l),a()})})}function W(t,e){try{let n=Di(t),r=Di(e);if(n!==r)return n==="Array"?1:r==="Array"?-1:n==="binary"?1:r==="binary"?-1:n==="string"?1:r==="string"?-1:n==="Date"?1:r!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return t>e?1:t<e?-1:0;case"binary":return Po(Ei(t),Ei(e));case"Array":return Oo(t,e)}}catch{}return NaN}function Oo(t,e){let n=t.length,r=e.length,i=n<r?n:r;for(let s=0;s<i;++s){let o=W(t[s],e[s]);if(o!==0)return o}return n===r?0:n<r?-1:1}function Po(t,e){let n=t.length,r=e.length,i=n<r?n:r;for(let s=0;s<i;++s)if(t[s]!==e[s])return t[s]<e[s]?-1:1;return n===r?0:n<r?-1:1}function Di(t){let e=typeof t;if(e!=="object")return e;if(ArrayBuffer.isView(t))return"binary";let n=Rn(t);return n==="ArrayBuffer"?"binary":n}function Ei(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):new Uint8Array(t)}var Qn=class{_read(e,n){var r=this._ctx;return r.error?r.table._trans(null,G.bind(null,r.error)):r.table._trans("readonly",e).then(n)}_write(e){var n=this._ctx;return n.error?n.table._trans(null,G.bind(null,n.error)):n.table._trans("readwrite",e,"locked")}_addAlgorithm(e){var n=this._ctx;n.algorithm=ke(n.algorithm,e)}_iterate(e,n){return Lt(this._ctx,e,n,this._ctx.table.core)}clone(e){var n=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return e&&z(r,e),n._ctx=r,n}raw(){return this._ctx.valueMapper=null,this}each(e){var n=this._ctx;return this._read(r=>Lt(n,e,r,n.table.core))}count(e){return this._read(n=>{let r=this._ctx,i=r.table.core;if(Le(r,!0))return i.count({trans:n,query:{index:Jt(r,i.schema),range:r.range}}).then(o=>Math.min(o,r.limit));var s=0;return Lt(r,()=>(++s,!1),n,i).then(()=>s)}).then(e)}sortBy(e,n){let r=e.split(".").reverse(),i=r[0],s=r.length-1;function o(u,d){return d?o(u[r[d]],d-1):u[i]}var a=this._ctx.dir==="next"?1:-1;function l(u,d){var f=o(u,s),c=o(d,s);return f<c?-a:f>c?a:0}return this.toArray(function(u){return u.sort(l)}).then(n)}toArray(e){return this._read(n=>{var r=this._ctx;if(r.dir==="next"&&Le(r,!0)&&r.limit>0){let{valueMapper:i}=r,s=Jt(r,r.table.core.schema);return r.table.core.query({trans:n,limit:r.limit,values:!0,query:{index:s,range:r.range}}).then(({result:o})=>i?o.map(i):o)}else{let i=[];return Lt(r,s=>i.push(s),n,r.table.core).then(()=>i)}},e)}offset(e){var n=this._ctx;return e<=0?this:(n.offset+=e,Le(n)?Tn(n,()=>{var r=e;return(i,s)=>r===0?!0:r===1?(--r,!1):(s(()=>{i.advance(r),r=0}),!1)}):Tn(n,()=>{var r=e;return()=>--r<0}),this)}limit(e){return this._ctx.limit=Math.min(this._ctx.limit,e),Tn(this._ctx,()=>{var n=e;return function(r,i,s){return--n<=0&&i(s),n>=0}},!0),this}until(e,n){return Pn(this._ctx,function(r,i,s){return e(r.value)?(i(s),n):!0}),this}first(e){return this.limit(1).toArray(function(n){return n[0]}).then(e)}last(e){return this.reverse().first(e)}filter(e){return Pn(this._ctx,function(n){return e(n.value)}),Fo(this._ctx,e),this}and(e){return this.filter(e)}or(e){return new this.db.WhereClause(this._ctx.table,e,this)}reverse(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this}desc(){return this.reverse()}eachKey(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,i){e(i.key,i)})}eachUniqueKey(e){return this._ctx.unique="unique",this.eachKey(e)}eachPrimaryKey(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,i){e(i.primaryKey,i)})}keys(e){var n=this._ctx;n.keysOnly=!n.isMatch;var r=[];return this.each(function(i,s){r.push(s.key)}).then(function(){return r}).then(e)}primaryKeys(e){var n=this._ctx;if(n.dir==="next"&&Le(n,!0)&&n.limit>0)return this._read(i=>{var s=Jt(n,n.table.core.schema);return n.table.core.query({trans:i,values:!1,limit:n.limit,query:{index:s,range:n.range}})}).then(({result:i})=>i).then(e);n.keysOnly=!n.isMatch;var r=[];return this.each(function(i,s){r.push(s.primaryKey)}).then(function(){return r}).then(e)}uniqueKeys(e){return this._ctx.unique="unique",this.keys(e)}firstKey(e){return this.limit(1).keys(function(n){return n[0]}).then(e)}lastKey(e){return this.reverse().firstKey(e)}distinct(){var e=this._ctx,n=e.index&&e.table.schema.idxByName[e.index];if(!n||!n.multi)return this;var r={};return Pn(this._ctx,function(i){var s=i.primaryKey.toString(),o=J(r,s);return r[s]=!0,!o}),this}modify(e){var n=this._ctx;return this._write(r=>{var i;if(typeof e=="function")i=e;else{var s=j(e),o=s.length;i=function(m){for(var v=!1,p=0;p<o;++p){var _=s[p],b=e[_];fe(m,_)!==b&&(re(m,_,b),v=!0)}return v}}let a=n.table.core,{outbound:l,extractKey:u}=a.schema.primaryKey,d=this.db._options.modifyChunkSize||200,f=[],c=0,h=[],y=(m,v)=>{let{failures:p,numFailures:_}=v;c+=m-_;for(let b of j(p))f.push(p[b])};return this.clone().primaryKeys().then(m=>{let v=p=>{let _=Math.min(d,m.length-p);return a.getMany({trans:r,keys:m.slice(p,p+_),cache:"immutable"}).then(b=>{let g=[],C=[],D=l?[]:null,E=[];for(let S=0;S<_;++S){let N=b[S],I={value:_t(N),primKey:m[p+S]};i.call(I,I.value,I)!==!1&&(I.value==null?E.push(m[p+S]):!l&&W(u(N),u(I.value))!==0?(E.push(m[p+S]),g.push(I.value)):(C.push(I.value),l&&D.push(m[p+S])))}let V=Le(n)&&n.limit===1/0&&(typeof e!="function"||e===kn)&&{index:n.index,range:n.range};return Promise.resolve(g.length>0&&a.mutate({trans:r,type:"add",values:g}).then(S=>{for(let N in S.failures)E.splice(parseInt(N),1);y(g.length,S)})).then(()=>(C.length>0||V&&typeof e=="object")&&a.mutate({trans:r,type:"put",keys:D,values:C,criteria:V,changeSpec:typeof e!="function"&&e}).then(S=>y(C.length,S))).then(()=>(E.length>0||V&&e===kn)&&a.mutate({trans:r,type:"delete",keys:E,criteria:V}).then(S=>y(E.length,S))).then(()=>m.length>p+_&&v(p+d))})};return v(0).then(()=>{if(f.length>0)throw new Zt("Error modifying one or more objects",f,c,h);return m.length})})})}delete(){var e=this._ctx,n=e.range;return Le(e)&&(e.isPrimKey&&!So||n.type===3)?this._write(r=>{let{primaryKey:i}=e.table.core.schema,s=n;return e.table.core.count({trans:r,query:{index:i,range:s}}).then(o=>e.table.core.mutate({trans:r,type:"deleteRange",range:s}).then(({failures:a,lastResult:l,results:u,numFailures:d})=>{if(d)throw new Zt("Could not delete some values",Object.keys(a).map(f=>a[f]),o-d);return o-d}))}):this.modify(kn)}},kn=(t,e)=>e.value=null;function To(t){return Et(Qn.prototype,function(n,r){this.db=t;let i=Xi,s=null;if(r)try{i=r()}catch(u){s=u}let o=n._ctx,a=o.table,l=a.hook.reading.fire;this._ctx={table:a,index:o.index,isPrimKey:!o.index||a.schema.primKey.keyPath&&o.index===a.schema.primKey.name,range:i,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:s,or:o.or,valueMapper:l!==bt?l:null}})}function ko(t,e){return t<e?-1:t===e?0:1}function No(t,e){return t>e?-1:t===e?0:1}function Q(t,e,n){var r=t instanceof on?new t.Collection(t):t;return r._ctx.error=n?new n(e):new TypeError(e),r}function $e(t){return new t.Collection(t,()=>Qi("")).limit(0)}function Ro(t){return t==="next"?e=>e.toUpperCase():e=>e.toLowerCase()}function Bo(t){return t==="next"?e=>e.toLowerCase():e=>e.toUpperCase()}function Ko(t,e,n,r,i,s){for(var o=Math.min(t.length,r.length),a=-1,l=0;l<o;++l){var u=e[l];if(u!==r[l])return i(t[l],n[l])<0?t.substr(0,l)+n[l]+n.substr(l+1):i(t[l],r[l])<0?t.substr(0,l)+r[l]+n.substr(l+1):a>=0?t.substr(0,a)+e[a]+n.substr(a+1):null;i(t[l],u)<0&&(a=l)}return o<r.length&&s==="next"?t+n.substr(t.length):o<t.length&&s==="prev"?t.substr(0,n.length):a<0?null:t.substr(0,a)+r[a]+n.substr(a+1)}function $t(t,e,n,r){var i,s,o,a,l,u,d,f=n.length;if(!n.every(m=>typeof m=="string"))return Q(t,qi);function c(m){i=Ro(m),s=Bo(m),o=m==="next"?ko:No;var v=n.map(function(p){return{lower:s(p),upper:i(p)}}).sort(function(p,_){return o(p.lower,_.lower)});a=v.map(function(p){return p.upper}),l=v.map(function(p){return p.lower}),u=m,d=m==="next"?"":r}c("next");var h=new t.Collection(t,()=>be(a[0],l[f-1]+r));h._ondirectionchange=function(m){c(m)};var y=0;return h._addAlgorithm(function(m,v,p){var _=m.key;if(typeof _!="string")return!1;var b=s(_);if(e(b,l,y))return!0;for(var g=null,C=y;C<f;++C){var D=Ko(_,b,a[C],l[C],o,u);D===null&&g===null?y=C+1:(g===null||o(g,D)>0)&&(g=D)}return v(g!==null?function(){m.continue(g+d)}:p),!1}),h}function be(t,e,n,r){return{type:2,lower:t,upper:e,lowerOpen:n,upperOpen:r}}function Qi(t){return{type:1,lower:t,upper:t}}var on=class{get Collection(){return this._ctx.table.db.Collection}between(e,n,r,i){r=r!==!1,i=i===!0;try{return this._cmp(e,n)>0||this._cmp(e,n)===0&&(r||i)&&!(r&&i)?$e(this):new this.Collection(this,()=>be(e,n,!r,!i))}catch{return Q(this,ue)}}equals(e){return e==null?Q(this,ue):new this.Collection(this,()=>Qi(e))}above(e){return e==null?Q(this,ue):new this.Collection(this,()=>be(e,void 0,!0))}aboveOrEqual(e){return e==null?Q(this,ue):new this.Collection(this,()=>be(e,void 0,!1))}below(e){return e==null?Q(this,ue):new this.Collection(this,()=>be(void 0,e,!1,!0))}belowOrEqual(e){return e==null?Q(this,ue):new this.Collection(this,()=>be(void 0,e))}startsWith(e){return typeof e!="string"?Q(this,qi):this.between(e,e+Fe,!0,!0)}startsWithIgnoreCase(e){return e===""?this.startsWith(e):$t(this,(n,r)=>n.indexOf(r[0])===0,[e],Fe)}equalsIgnoreCase(e){return $t(this,(n,r)=>n===r[0],[e],"")}anyOfIgnoreCase(){var e=de.apply(We,arguments);return e.length===0?$e(this):$t(this,(n,r)=>r.indexOf(n)!==-1,e,"")}startsWithAnyOfIgnoreCase(){var e=de.apply(We,arguments);return e.length===0?$e(this):$t(this,(n,r)=>r.some(i=>n.indexOf(i)===0),e,Fe)}anyOf(){let e=de.apply(We,arguments),n=this._cmp;try{e.sort(n)}catch{return Q(this,ue)}if(e.length===0)return $e(this);let r=new this.Collection(this,()=>be(e[0],e[e.length-1]));r._ondirectionchange=s=>{n=s==="next"?this._ascending:this._descending,e.sort(n)};let i=0;return r._addAlgorithm((s,o,a)=>{let l=s.key;for(;n(l,e[i])>0;)if(++i,i===e.length)return o(a),!1;return n(l,e[i])===0?!0:(o(()=>{s.continue(e[i])}),!1)}),r}notEqual(e){return this.inAnyRange([[Yn,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})}noneOf(){let e=de.apply(We,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return Q(this,ue)}let n=e.reduce((r,i)=>r?r.concat([[r[r.length-1][1],i]]):[[Yn,i]],null);return n.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})}inAnyRange(e,n){let r=this._cmp,i=this._ascending,s=this._descending,o=this._min,a=this._max;if(e.length===0)return $e(this);if(!e.every(g=>g[0]!==void 0&&g[1]!==void 0&&i(g[0],g[1])<=0))return Q(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",M.InvalidArgument);let l=!n||n.includeLowers!==!1,u=n&&n.includeUppers===!0;function d(g,C){let D=0,E=g.length;for(;D<E;++D){let V=g[D];if(r(C[0],V[1])<0&&r(C[1],V[0])>0){V[0]=o(V[0],C[0]),V[1]=a(V[1],C[1]);break}}return D===E&&g.push(C),g}let f=i;function c(g,C){return f(g[0],C[0])}let h;try{h=e.reduce(d,[]),h.sort(c)}catch{return Q(this,ue)}let y=0,m=u?g=>i(g,h[y][1])>0:g=>i(g,h[y][1])>=0,v=l?g=>s(g,h[y][0])>0:g=>s(g,h[y][0])>=0;function p(g){return!m(g)&&!v(g)}let _=m,b=new this.Collection(this,()=>be(h[0][0],h[h.length-1][1],!l,!u));return b._ondirectionchange=g=>{g==="next"?(_=m,f=i):(_=v,f=s),h.sort(c)},b._addAlgorithm((g,C,D)=>{for(var E=g.key;_(E);)if(++y,y===h.length)return C(D),!1;return p(E)?!0:(this._cmp(E,h[y][1])===0||this._cmp(E,h[y][0])===0||C(()=>{f===i?g.continue(h[y][0]):g.continue(h[y][1])}),!1)}),b}startsWithAnyOf(){let e=de.apply(We,arguments);return e.every(n=>typeof n=="string")?e.length===0?$e(this):this.inAnyRange(e.map(n=>[n,n+Fe])):Q(this,"startsWithAnyOf() only works with strings")}};function jo(t){return Et(on.prototype,function(n,r,i){this.db=t,this._ctx={table:n,index:r===":id"?null:r,or:i};let s=t._deps.indexedDB;if(!s)throw new M.MissingAPI;this._cmp=this._ascending=s.cmp.bind(s),this._descending=(o,a)=>s.cmp(a,o),this._max=(o,a)=>s.cmp(o,a)>0?o:a,this._min=(o,a)=>s.cmp(o,a)<0?o:a,this._IDBKeyRange=t._deps.IDBKeyRange})}function oe(t){return R(function(e){return mt(e),t(e.target.error),!1})}function mt(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault()}var gt="storagemutated",Ce="x-storagemutated-1",Ae=Dt(null,gt),Jn=class{_lock(){return at(!A.global),++this._reculock,this._reculock===1&&!A.global&&(A.lockOwnerFor=this),this}_unlock(){if(at(!A.global),--this._reculock===0)for(A.global||(A.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{Ze(e[1],e[0])}catch{}}return this}_locked(){return this._reculock&&A.lockOwnerFor!==this}create(e){if(!this.mode)return this;let n=this.db.idbdb,r=this.db._state.dbOpenError;if(at(!this.idbtrans),!e&&!n)switch(r&&r.name){case"DatabaseClosedError":throw new M.DatabaseClosed(r);case"MissingAPIError":throw new M.MissingAPI(r.message,r);default:throw new M.OpenFailed(r)}if(!this.active)throw new M.TransactionInactive;return at(this._completion._state===null),e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):n.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})),e.onerror=R(i=>{mt(i),this._reject(e.error)}),e.onabort=R(i=>{mt(i),this.active&&this._reject(new M.Abort(e.error)),this.active=!1,this.on("abort").fire(i)}),e.oncomplete=R(()=>{this.active=!1,this._resolve(),"mutatedParts"in e&&Ae.storagemutated.fire(e.mutatedParts)}),this}_promise(e,n,r){if(e==="readwrite"&&this.mode!=="readwrite")return G(new M.ReadOnly("Transaction is readonly"));if(!this.active)return G(new M.TransactionInactive);if(this._locked())return new w((s,o)=>{this._blockedFuncs.push([()=>{this._promise(e,n,r).then(s,o)},A])});if(r)return De(()=>{var s=new w((o,a)=>{this._lock();let l=n(o,a,this);l&&l.then&&l.then(o,a)});return s.finally(()=>this._unlock()),s._lib=!0,s});var i=new w((s,o)=>{var a=n(s,o,this);a&&a.then&&a.then(s,o)});return i._lib=!0,i}_root(){return this.parent?this.parent._root():this}waitFor(e){var n=this._root();let r=w.resolve(e);if(n._waitingFor)n._waitingFor=n._waitingFor.then(()=>r);else{n._waitingFor=r,n._waitingQueue=[];var i=n.idbtrans.objectStore(n.storeNames[0]);(function o(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(i.get(-1/0).onsuccess=o)})()}var s=n._waitingFor;return new w((o,a)=>{r.then(l=>n._waitingQueue.push(R(o.bind(null,l))),l=>n._waitingQueue.push(R(a.bind(null,l)))).finally(()=>{n._waitingFor===s&&(n._waitingFor=null)})})}abort(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new M.Abort))}table(e){let n=this._memoizedTables||(this._memoizedTables={});if(J(n,e))return n[e];let r=this.schema[e];if(!r)throw new M.NotFound("Table "+e+" not part of transaction");let i=new this.db.Table(e,r,this);return i.core=this.db.core.table(e),n[e]=i,i}};function Go(t){return Et(Jn.prototype,function(n,r,i,s,o){this.db=t,this.mode=n,this.storeNames=r,this.schema=i,this.chromeTransactionDurability=s,this.idbtrans=null,this.on=Dt(this,"complete","error","abort"),this.parent=o||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new w((a,l)=>{this._resolve=a,this._reject=l}),this._completion.then(()=>{this.active=!1,this.on.complete.fire()},a=>{var l=this.active;return this.active=!1,this.on.error.fire(a),this.parent?this.parent._reject(a):l&&this.idbtrans&&this.idbtrans.abort(),G(a)})})}function Zn(t,e,n,r,i,s,o){return{name:t,keyPath:e,unique:n,multi:r,auto:i,compound:s,src:(n&&!o?"&":"")+(r?"*":"")+(i?"++":"")+Ji(e)}}function Ji(t){return typeof t=="string"?t:t?"["+[].join.call(t,"+")+"]":""}function Zi(t,e,n){return{name:t,primKey:e,indexes:n,mappedClass:null,idxByName:Fi(n,r=>[r.name,r])}}function Uo(t){return t.length===1?t[0]:t}var yt=t=>{try{return t.only([[]]),yt=()=>[[]],[[]]}catch{return yt=()=>Fe,Fe}};function er(t){return t==null?()=>{}:typeof t=="string"?Ho(t):e=>fe(e,t)}function Ho(t){return t.split(".").length===1?n=>n[t]:n=>fe(n,t)}function Ai(t){return[].slice.call(t)}var Lo=0;function dt(t){return t==null?":id":typeof t=="string"?t:`[${t.join("+")}]`}function $o(t,e,n){function r(d,f){let c=Ai(d.objectStoreNames);return{schema:{name:d.name,tables:c.map(h=>f.objectStore(h)).map(h=>{let{keyPath:y,autoIncrement:m}=h,v=$(y),p=y==null,_={},b={name:h.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:p,compound:v,keyPath:y,autoIncrement:m,unique:!0,extractKey:er(y)},indexes:Ai(h.indexNames).map(g=>h.index(g)).map(g=>{let{name:C,unique:D,multiEntry:E,keyPath:V}=g,S=$(V),N={name:C,compound:S,keyPath:V,unique:D,multiEntry:E,extractKey:er(V)};return _[dt(V)]=N,N}),getIndexByKeyPath:g=>_[dt(g)]};return _[":id"]=b.primaryKey,y!=null&&(_[dt(y)]=b.primaryKey),b})},hasGetAll:c.length>0&&"getAll"in f.objectStore(c[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}function i(d){if(d.type===3)return null;if(d.type===4)throw new Error("Cannot convert never type to IDBKeyRange");let{lower:f,upper:c,lowerOpen:h,upperOpen:y}=d;return f===void 0?c===void 0?null:e.upperBound(c,!!y):c===void 0?e.lowerBound(f,!!h):e.bound(f,c,!!h,!!y)}function s(d){let f=d.name;function c({trans:m,type:v,keys:p,values:_,range:b}){return new Promise((g,C)=>{g=R(g);let D=m.objectStore(f),E=D.keyPath==null,V=v==="put"||v==="add";if(!V&&v!=="delete"&&v!=="deleteRange")throw new Error("Invalid operation type: "+v);let{length:S}=p||_||{length:1};if(p&&_&&p.length!==_.length)throw new Error("Given keys array must have same length as given values array.");if(S===0)return g({numFailures:0,failures:{},results:[],lastResult:void 0});let N,I=[],q=[],x=0,ee=Y=>{++x,mt(Y)};if(v==="deleteRange"){if(b.type===4)return g({numFailures:x,failures:q,results:[],lastResult:void 0});b.type===3?I.push(N=D.clear()):I.push(N=D.delete(i(b)))}else{let[Y,Z]=V?E?[_,p]:[_,null]:[p,null];if(V)for(let H=0;H<S;++H)I.push(N=Z&&Z[H]!==void 0?D[v](Y[H],Z[H]):D[v](Y[H])),N.onerror=ee;else for(let H=0;H<S;++H)I.push(N=D[v](Y[H])),N.onerror=ee}let te=Y=>{let Z=Y.target.result;I.forEach((H,et)=>H.error!=null&&(q[et]=H.error)),g({numFailures:x,failures:q,results:v==="delete"?p:I.map(H=>H.result),lastResult:Z})};N.onerror=Y=>{ee(Y),te(Y)},N.onsuccess=te})}function h({trans:m,values:v,query:p,reverse:_,unique:b}){return new Promise((g,C)=>{g=R(g);let{index:D,range:E}=p,V=m.objectStore(f),S=D.isPrimaryKey?V:V.index(D.name),N=_?b?"prevunique":"prev":b?"nextunique":"next",I=v||!("openKeyCursor"in S)?S.openCursor(i(E),N):S.openKeyCursor(i(E),N);I.onerror=oe(C),I.onsuccess=R(q=>{let x=I.result;if(!x){g(null);return}x.___id=++Lo,x.done=!1;let ee=x.continue.bind(x),te=x.continuePrimaryKey;te&&(te=te.bind(x));let Y=x.advance.bind(x),Z=()=>{throw new Error("Cursor not started")},H=()=>{throw new Error("Cursor not stopped")};x.trans=m,x.stop=x.continue=x.continuePrimaryKey=x.advance=Z,x.fail=R(C),x.next=function(){let et=1;return this.start(()=>et--?this.continue():this.stop()).then(()=>this)},x.start=et=>{let cs=new Promise((Re,Ar)=>{Re=R(Re),I.onerror=oe(Ar),x.fail=Ar,x.stop=ds=>{x.stop=x.continue=x.continuePrimaryKey=x.advance=H,Re(ds)}}),pn=()=>{if(I.result)try{et()}catch(Re){x.fail(Re)}else x.done=!0,x.start=()=>{throw new Error("Cursor behind last entry")},x.stop()};return I.onsuccess=R(Re=>{I.onsuccess=pn,pn()}),x.continue=ee,x.continuePrimaryKey=te,x.advance=Y,pn(),cs},g(x)},C)})}function y(m){return v=>new Promise((p,_)=>{p=R(p);let{trans:b,values:g,limit:C,query:D}=v,E=C===1/0?void 0:C,{index:V,range:S}=D,N=b.objectStore(f),I=V.isPrimaryKey?N:N.index(V.name),q=i(S);if(C===0)return p({result:[]});if(m){let x=g?I.getAll(q,E):I.getAllKeys(q,E);x.onsuccess=ee=>p({result:ee.target.result}),x.onerror=oe(_)}else{let x=0,ee=g||!("openKeyCursor"in I)?I.openCursor(q):I.openKeyCursor(q),te=[];ee.onsuccess=Y=>{let Z=ee.result;if(!Z)return p({result:te});if(te.push(g?Z.value:Z.primaryKey),++x===C)return p({result:te});Z.continue()},ee.onerror=oe(_)}})}return{name:f,schema:d,mutate:c,getMany({trans:m,keys:v}){return new Promise((p,_)=>{p=R(p);let b=m.objectStore(f),g=v.length,C=new Array(g),D=0,E=0,V,S=I=>{let q=I.target;(C[q._pos]=q.result)!=null,++E===D&&p(C)},N=oe(_);for(let I=0;I<g;++I)v[I]!=null&&(V=b.get(v[I]),V._pos=I,V.onsuccess=S,V.onerror=N,++D);D===0&&p(C)})},get({trans:m,key:v}){return new Promise((p,_)=>{p=R(p);let g=m.objectStore(f).get(v);g.onsuccess=C=>p(C.target.result),g.onerror=oe(_)})},query:y(a),openCursor:h,count({query:m,trans:v}){let{index:p,range:_}=m;return new Promise((b,g)=>{let C=v.objectStore(f),D=p.isPrimaryKey?C:C.index(p.name),E=i(_),V=E?D.count(E):D.count();V.onsuccess=R(S=>b(S.target.result)),V.onerror=oe(g)})}}}let{schema:o,hasGetAll:a}=r(t,n),l=o.tables.map(d=>s(d)),u={};return l.forEach(d=>u[d.name]=d),{stack:"dbcore",transaction:t.transaction.bind(t),table(d){if(!u[d])throw new Error(`Table '${d}' not found`);return u[d]},MIN_KEY:-1/0,MAX_KEY:yt(e),schema:o}}function Wo(t,e){return e.reduce((n,{create:r})=>O(O({},n),r(n)),t)}function zo(t,e,{IDBKeyRange:n,indexedDB:r},i){return{dbcore:Wo($o(e,n,i),t.dbcore)}}function vr({_novip:t},e){let n=e.db,r=zo(t._middlewares,n,t._deps,e);t.core=r.dbcore,t.tables.forEach(i=>{let s=i.name;t.core.schema.tables.some(o=>o.name===s)&&(i.core=t.core.table(s),t[s]instanceof t.Table&&(t[s].core=i.core))})}function an({_novip:t},e,n,r){n.forEach(i=>{let s=r[i];e.forEach(o=>{let a=cr(o,i);(!a||"value"in a&&a.value===void 0)&&(o===t.Transaction.prototype||o instanceof t.Transaction?pe(o,i,{get(){return this.table(i)},set(l){xi(this,i,{value:l,writable:!0,configurable:!0,enumerable:!0})}}):o[i]=new t.Table(i,s))})})}function tr({_novip:t},e){e.forEach(n=>{for(let r in n)n[r]instanceof t.Table&&delete n[r]})}function qo(t,e){return t._cfg.version-e._cfg.version}function Yo(t,e,n,r){let i=t._dbSchema,s=t._createTransaction("readwrite",t._storeNames,i);s.create(n),s._completion.catch(r);let o=s._reject.bind(s),a=A.transless||A;De(()=>{A.trans=s,A.transless=a,e===0?(j(i).forEach(l=>{_r(n,l,i[l].primKey,i[l].indexes)}),vr(t,n),w.follow(()=>t.on.populate.fire(s)).catch(o)):Xo(t,e,s,n).catch(o)})}function Xo({_novip:t},e,n,r){let i=[],s=t._versions,o=t._dbSchema=br(t,t.idbdb,r),a=!1;s.filter(d=>d._cfg.version>=e).forEach(d=>{i.push(()=>{let f=o,c=d._cfg.dbschema;rr(t,f,r),rr(t,c,r),o=t._dbSchema=c;let h=es(f,c);h.add.forEach(m=>{_r(r,m[0],m[1].primKey,m[1].indexes)}),h.change.forEach(m=>{if(m.recreate)throw new M.Upgrade("Not yet support for changing primary key");{let v=r.objectStore(m.name);m.add.forEach(p=>nr(v,p)),m.change.forEach(p=>{v.deleteIndex(p.name),nr(v,p)}),m.del.forEach(p=>v.deleteIndex(p))}});let y=d._cfg.contentUpgrade;if(y&&d._cfg.version>e){vr(t,r),n._memoizedTables={},a=!0;let m=Oi(c);h.del.forEach(b=>{m[b]=f[b]}),tr(t,[t.Transaction.prototype]),an(t,[t.Transaction.prototype],j(m),m),n.schema=m;let v=dr(y);v&&Je();let p,_=w.follow(()=>{if(p=y(n),p&&v){var b=me.bind(null,null);p.then(b,b)}});return p&&typeof p.then=="function"?w.resolve(p):_.then(()=>p)}}),i.push(f=>{if(!a||!xo){let c=d._cfg.dbschema;Jo(c,f)}tr(t,[t.Transaction.prototype]),an(t,[t.Transaction.prototype],t._storeNames,t._dbSchema),n.schema=t._dbSchema})});function u(){return i.length?w.resolve(i.shift()(n.idbtrans)).then(u):w.resolve()}return u().then(()=>{Qo(o,r)})}function es(t,e){let n={del:[],add:[],change:[]},r;for(r in t)e[r]||n.del.push(r);for(r in e){let i=t[r],s=e[r];if(!i)n.add.push([r,s]);else{let o={name:r,def:s,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(s.primKey.keyPath||"")||i.primKey.auto!==s.primKey.auto&&!hn)o.recreate=!0,n.change.push(o);else{let a=i.idxByName,l=s.idxByName,u;for(u in a)l[u]||o.del.push(u);for(u in l){let d=a[u],f=l[u];d?d.src!==f.src&&o.change.push(f):o.add.push(f)}(o.del.length>0||o.add.length>0||o.change.length>0)&&n.change.push(o)}}}return n}function _r(t,e,n,r){let i=t.db.createObjectStore(e,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(s=>nr(i,s)),i}function Qo(t,e){j(t).forEach(n=>{e.db.objectStoreNames.contains(n)||_r(e,n,t[n].primKey,t[n].indexes)})}function Jo(t,e){[].slice.call(e.db.objectStoreNames).forEach(n=>t[n]==null&&e.db.deleteObjectStore(n))}function nr(t,e){t.createIndex(e.name,e.keyPath,{unique:e.unique,multiEntry:e.multi})}function br(t,e,n){let r={};return cn(e.objectStoreNames,0).forEach(s=>{let o=n.objectStore(s),a=o.keyPath,l=Zn(Ji(a),a||"",!1,!1,!!o.autoIncrement,a&&typeof a!="string",!0),u=[];for(let f=0;f<o.indexNames.length;++f){let c=o.index(o.indexNames[f]);a=c.keyPath;var d=Zn(c.name,a,!!c.unique,!!c.multiEntry,!1,a&&typeof a!="string",!1);u.push(d)}r[s]=Zi(s,l,u)}),r}function Zo({_novip:t},e,n){t.verno=e.version/10;let r=t._dbSchema=br(t,e,n);t._storeNames=cn(e.objectStoreNames,0),an(t,[t._allTables],j(r),r)}function ea(t,e){let n=br(t,t.idbdb,e),r=es(n,t._dbSchema);return!(r.add.length||r.change.some(i=>i.add.length||i.change.length))}function rr({_novip:t},e,n){let r=n.db.objectStoreNames;for(let i=0;i<r.length;++i){let s=r[i],o=n.objectStore(s);t._hasGetAll="getAll"in o;for(let a=0;a<o.indexNames.length;++a){let l=o.indexNames[a],u=o.index(l).keyPath,d=typeof u=="string"?u:"["+cn(u).join("+")+"]";if(e[s]){let f=e[s].idxByName[d];f&&(f.name=l,delete e[s].idxByName[d],e[s].idxByName[l]=f)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&k.WorkerGlobalScope&&k instanceof k.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(t._hasGetAll=!1)}function ta(t){return t.split(",").map((e,n)=>{e=e.trim();let r=e.replace(/([&*]|\+\+)/g,""),i=/^\[/.test(r)?r.match(/^\[(.*)\]$/)[1].split("+"):r;return Zn(r,i||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),$(i),n===0)})}var ir=class{_parseStoresSpec(e,n){j(e).forEach(r=>{if(e[r]!==null){var i=ta(e[r]),s=i.shift();if(s.multi)throw new M.Schema("Primary key cannot be multi-valued");i.forEach(o=>{if(o.auto)throw new M.Schema("Only primary key can be marked as autoIncrement (++)");if(!o.keyPath)throw new M.Schema("Index must have a name and cannot be an empty string")}),n[r]=Zi(r,s,i)}})}stores(e){let n=this.db;this._cfg.storesSource=this._cfg.storesSource?z(this._cfg.storesSource,e):e;let r=n._versions,i={},s={};return r.forEach(o=>{z(i,o._cfg.storesSource),s=o._cfg.dbschema={},o._parseStoresSpec(i,s)}),n._dbSchema=s,tr(n,[n._allTables,n,n.Transaction.prototype]),an(n,[n._allTables,n,n.Transaction.prototype,this._cfg.tables],j(s),s),n._storeNames=j(s),this}upgrade(e){return this._cfg.contentUpgrade=pr(this._cfg.contentUpgrade||T,e),this}};function na(t){return Et(ir.prototype,function(n){this.db=t,this._cfg={version:n,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}function wr(t,e){let n=t._dbNamesDB;return n||(n=t._dbNamesDB=new Ye(fn,{addons:[],indexedDB:t,IDBKeyRange:e}),n.version(1).stores({dbnames:"name"})),n.table("dbnames")}function Cr(t){return t&&typeof t.databases=="function"}function ra({indexedDB:t,IDBKeyRange:e}){return Cr(t)?Promise.resolve(t.databases()).then(n=>n.map(r=>r.name).filter(r=>r!==fn)):wr(t,e).toCollection().primaryKeys()}function ia({indexedDB:t,IDBKeyRange:e},n){!Cr(t)&&n!==fn&&wr(t,e).put({name:n}).catch(T)}function sa({indexedDB:t,IDBKeyRange:e},n){!Cr(t)&&n!==fn&&wr(t,e).delete(n).catch(T)}function sr(t){return De(function(){return A.letThrough=!0,t()})}function oa(){var t=!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent);if(!t||!indexedDB.databases)return Promise.resolve();var e;return new Promise(function(n){var r=function(){return indexedDB.databases().finally(n)};e=setInterval(r,100),r()}).finally(function(){return clearInterval(e)})}function aa(t){let e=t._state,{indexedDB:n}=t._deps;if(e.isBeingOpened||t.idbdb)return e.dbReadyPromise.then(()=>e.dbOpenError?G(e.dbOpenError):t);ae&&(e.openCanceller._stackHolder=Ne()),e.isBeingOpened=!0,e.dbOpenError=null,e.openComplete=!1;let r=e.openCanceller;function i(){if(e.openCanceller!==r)throw new M.DatabaseClosed("db.open() was cancelled")}let s=e.dbReadyResolve,o=null,a=!1;return w.race([r,(typeof navigator>"u"?w.resolve():oa()).then(()=>new w((l,u)=>{if(i(),!n)throw new M.MissingAPI;let d=t.name,f=e.autoSchema?n.open(d):n.open(d,Math.round(t.verno*10));if(!f)throw new M.MissingAPI;f.onerror=oe(u),f.onblocked=R(t._fireOnBlocked),f.onupgradeneeded=R(c=>{if(o=f.transaction,e.autoSchema&&!t._options.allowEmptyDB){f.onerror=mt,o.abort(),f.result.close();let y=n.deleteDatabase(d);y.onsuccess=y.onerror=R(()=>{u(new M.NoSuchDatabase(`Database ${d} doesnt exist`))})}else{o.onerror=oe(u);var h=c.oldVersion>Math.pow(2,62)?0:c.oldVersion;a=h<1,t._novip.idbdb=f.result,Yo(t,h/10,o,u)}},u),f.onsuccess=R(()=>{o=null;let c=t._novip.idbdb=f.result,h=cn(c.objectStoreNames);if(h.length>0)try{let y=c.transaction(Uo(h),"readonly");e.autoSchema?Zo(t,c,y):(rr(t,t._dbSchema,y),ea(t,y)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),vr(t,y)}catch{}ct.push(t),c.onversionchange=R(y=>{e.vcFired=!0,t.on("versionchange").fire(y)}),c.onclose=R(y=>{t.on("close").fire(y)}),a&&ia(t._deps,d),l()},u)}))]).then(()=>(i(),e.onReadyBeingFired=[],w.resolve(sr(()=>t.on.ready.fire(t.vip))).then(function l(){if(e.onReadyBeingFired.length>0){let u=e.onReadyBeingFired.reduce(pr,T);return e.onReadyBeingFired=[],w.resolve(sr(()=>u(t.vip))).then(l)}}))).finally(()=>{e.onReadyBeingFired=null,e.isBeingOpened=!1}).then(()=>t).catch(l=>{e.dbOpenError=l;try{o&&o.abort()}catch{}return r===e.openCanceller&&t._close(),G(l)}).finally(()=>{e.openComplete=!0,s()})}function or(t){var e=o=>t.next(o),n=o=>t.throw(o),r=s(e),i=s(n);function s(o){return a=>{var l=o(a),u=l.value;return l.done?u:!u||typeof u.then!="function"?$(u)?Promise.all(u).then(r,i):r(u):u.then(r,i)}}return s(e)()}function la(t,e,n){var r=arguments.length;if(r<2)throw new M.InvalidArgument("Too few arguments");for(var i=new Array(r-1);--r;)i[r-1]=arguments[r];n=i.pop();var s=Pi(i);return[t,s,n]}function ts(t,e,n,r,i){return w.resolve().then(()=>{let s=A.transless||A,o=t._createTransaction(e,n,t._dbSchema,r),a={trans:o,transless:s};if(r)o.idbtrans=r.idbtrans;else try{o.create(),t._state.PR1398_maxLoop=3}catch(f){return f.name===fr.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(()=>ts(t,e,n,null,i))):G(f)}let l=dr(i);l&&Je();let u,d=w.follow(()=>{if(u=i.call(o,o),u)if(l){var f=me.bind(null,null);u.then(f,f)}else typeof u.next=="function"&&typeof u.throw=="function"&&(u=or(u))},a);return(u&&typeof u.then=="function"?w.resolve(u).then(f=>o.active?f:G(new M.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))):d.then(()=>u)).then(f=>(r&&o._resolve(),o._completion.then(()=>f))).catch(f=>(o._reject(f),G(f)))})}function Wt(t,e,n){let r=$(t)?t.slice():[t];for(let i=0;i<n;++i)r.push(e);return r}function ua(t){return K(O({},t),{table(e){let n=t.table(e),{schema:r}=n,i={},s=[];function o(c,h,y){let m=dt(c),v=i[m]=i[m]||[],p=c==null?0:typeof c=="string"?1:c.length,_=h>0,b=K(O({},y),{isVirtual:_,keyTail:h,keyLength:p,extractKey:er(c),unique:!_&&y.unique});if(v.push(b),b.isPrimaryKey||s.push(b),p>1){let g=p===2?c[0]:c.slice(0,p-1);o(g,h+1,y)}return v.sort((g,C)=>g.keyTail-C.keyTail),b}let a=o(r.primaryKey.keyPath,0,r.primaryKey);i[":id"]=[a];for(let c of r.indexes)o(c.keyPath,0,c);function l(c){let h=i[dt(c)];return h&&h[0]}function u(c,h){return{type:c.type===1?2:c.type,lower:Wt(c.lower,c.lowerOpen?t.MAX_KEY:t.MIN_KEY,h),lowerOpen:!0,upper:Wt(c.upper,c.upperOpen?t.MIN_KEY:t.MAX_KEY,h),upperOpen:!0}}function d(c){let h=c.query.index;return h.isVirtual?K(O({},c),{query:{index:h,range:u(c.query.range,h.keyTail)}}):c}return K(O({},n),{schema:K(O({},r),{primaryKey:a,indexes:s,getIndexByKeyPath:l}),count(c){return n.count(d(c))},query(c){return n.query(d(c))},openCursor(c){let{keyTail:h,isVirtual:y,keyLength:m}=c.query.index;if(!y)return n.openCursor(c);function v(p){function _(g){g!=null?p.continue(Wt(g,c.reverse?t.MAX_KEY:t.MIN_KEY,h)):c.unique?p.continue(p.key.slice(0,m).concat(c.reverse?t.MIN_KEY:t.MAX_KEY,h)):p.continue()}return Object.create(p,{continue:{value:_},continuePrimaryKey:{value(g,C){p.continuePrimaryKey(Wt(g,t.MAX_KEY,h),C)}},primaryKey:{get(){return p.primaryKey}},key:{get(){let g=p.key;return m===1?g[0]:g.slice(0,m)}},value:{get(){return p.value}}})}return n.openCursor(d(c)).then(p=>p&&v(p))}})}})}var ca={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:ua};function Dr(t,e,n,r){return n=n||{},r=r||"",j(t).forEach(i=>{if(!J(e,i))n[r+i]=void 0;else{var s=t[i],o=e[i];if(typeof s=="object"&&typeof o=="object"&&s&&o){let a=Rn(s),l=Rn(o);a!==l?n[r+i]=e[i]:a==="Object"?Dr(s,o,n,r+i+"."):s!==o&&(n[r+i]=e[i])}else s!==o&&(n[r+i]=e[i])}}),j(e).forEach(i=>{J(t,i)||(n[r+i]=e[i])}),n}function da(t,e){return e.type==="delete"?e.keys:e.keys||e.values.map(t.extractKey)}var ha={stack:"dbcore",name:"HooksMiddleware",level:2,create:t=>K(O({},t),{table(e){let n=t.table(e),{primaryKey:r}=n.schema;return K(O({},n),{mutate(s){let o=A.trans,{deleting:a,creating:l,updating:u}=o.table(e).hook;switch(s.type){case"add":if(l.fire===T)break;return o._promise("readwrite",()=>d(s),!0);case"put":if(l.fire===T&&u.fire===T)break;return o._promise("readwrite",()=>d(s),!0);case"delete":if(a.fire===T)break;return o._promise("readwrite",()=>d(s),!0);case"deleteRange":if(a.fire===T)break;return o._promise("readwrite",()=>f(s),!0)}return n.mutate(s);function d(h){let y=A.trans,m=h.keys||da(r,h);if(!m)throw new Error("Keys missing");return h=h.type==="add"||h.type==="put"?K(O({},h),{keys:m}):O({},h),h.type!=="delete"&&(h.values=[...h.values]),h.keys&&(h.keys=[...h.keys]),fa(n,h,m).then(v=>{let p=m.map((_,b)=>{let g=v[b],C={onerror:null,onsuccess:null};if(h.type==="delete")a.fire.call(C,_,g,y);else if(h.type==="add"||g===void 0){let D=l.fire.call(C,_,h.values[b],y);_==null&&D!=null&&(_=D,h.keys[b]=_,r.outbound||re(h.values[b],r.keyPath,_))}else{let D=Dr(g,h.values[b]),E=u.fire.call(C,D,_,g,y);if(E){let V=h.values[b];Object.keys(E).forEach(S=>{J(V,S)?V[S]=E[S]:re(V,S,E[S])})}}return C});return n.mutate(h).then(({failures:_,results:b,numFailures:g,lastResult:C})=>{for(let D=0;D<m.length;++D){let E=b?b[D]:m[D],V=p[D];E==null?V.onerror&&V.onerror(_[D]):V.onsuccess&&V.onsuccess(h.type==="put"&&v[D]?h.values[D]:E)}return{failures:_,results:b,numFailures:g,lastResult:C}}).catch(_=>(p.forEach(b=>b.onerror&&b.onerror(_)),Promise.reject(_)))})}function f(h){return c(h.trans,h.range,1e4)}function c(h,y,m){return n.query({trans:h,values:!1,query:{index:r,range:y},limit:m}).then(({result:v})=>d({type:"delete",keys:v,trans:h}).then(p=>p.numFailures>0?Promise.reject(p.failures[0]):v.length<m?{failures:[],numFailures:0,lastResult:void 0}:c(h,K(O({},y),{lower:v[v.length-1],lowerOpen:!0}),m)))}}})}})};function fa(t,e,n){return e.type==="add"?Promise.resolve([]):t.getMany({trans:e.trans,keys:n,cache:"immutable"})}function ns(t,e,n){try{if(!e||e.keys.length<t.length)return null;let r=[];for(let i=0,s=0;i<e.keys.length&&s<t.length;++i)W(e.keys[i],t[s])===0&&(r.push(n?_t(e.values[i]):e.values[i]),++s);return r.length===t.length?r:null}catch{return null}}var pa={stack:"dbcore",level:-1,create:t=>({table:e=>{let n=t.table(e);return K(O({},n),{getMany:r=>{if(!r.cache)return n.getMany(r);let i=ns(r.keys,r.trans._cache,r.cache==="clone");return i?w.resolve(i):n.getMany(r).then(s=>(r.trans._cache={keys:r.keys,values:r.cache==="clone"?_t(s):s},s))},mutate:r=>(r.type!=="add"&&(r.trans._cache=null),n.mutate(r))})}})};function Er(t){return!("from"in t)}var ce=function(t,e){if(this)z(this,arguments.length?{d:1,from:t,to:arguments.length>1?e:t}:{d:0});else{let n=new ce;return t&&"d"in t&&z(n,t),n}};qe(ce.prototype,{add(t){return ln(this,t),this},addKey(t){return vt(this,t,t),this},addKeys(t){return t.forEach(e=>vt(this,e,e)),this},[Bn](){return ar(this)}});function vt(t,e,n){let r=W(e,n);if(isNaN(r))return;if(r>0)throw RangeError();if(Er(t))return z(t,{from:e,to:n,d:1});let i=t.l,s=t.r;if(W(n,t.from)<0)return i?vt(i,e,n):t.l={from:e,to:n,d:1,l:null,r:null},Mi(t);if(W(e,t.to)>0)return s?vt(s,e,n):t.r={from:e,to:n,d:1,l:null,r:null},Mi(t);W(e,t.from)<0&&(t.from=e,t.l=null,t.d=s?s.d+1:1),W(n,t.to)>0&&(t.to=n,t.r=null,t.d=t.l?t.l.d+1:1);let o=!t.r;i&&!t.l&&ln(t,i),s&&o&&ln(t,s)}function ln(t,e){function n(r,{from:i,to:s,l:o,r:a}){vt(r,i,s),o&&n(r,o),a&&n(r,a)}Er(e)||n(t,e)}function ma(t,e){let n=ar(e),r=n.next();if(r.done)return!1;let i=r.value,s=ar(t),o=s.next(i.from),a=o.value;for(;!r.done&&!o.done;){if(W(a.from,i.to)<=0&&W(a.to,i.from)>=0)return!0;W(i.from,a.from)<0?i=(r=n.next(a.from)).value:a=(o=s.next(i.from)).value}return!1}function ar(t){let e=Er(t)?null:{s:0,n:t};return{next(n){let r=arguments.length>0;for(;e;)switch(e.s){case 0:if(e.s=1,r)for(;e.n.l&&W(n,e.n.from)<0;)e={up:e,n:e.n.l,s:1};else for(;e.n.l;)e={up:e,n:e.n.l,s:1};case 1:if(e.s=2,!r||W(n,e.n.to)<=0)return{value:e.n,done:!1};case 2:if(e.n.r){e.s=3,e={up:e,n:e.n.r,s:0};continue}case 3:e=e.up}return{done:!0}}}}function Mi(t){var e,n;let r=(((e=t.r)===null||e===void 0?void 0:e.d)||0)-(((n=t.l)===null||n===void 0?void 0:n.d)||0),i=r>1?"r":r<-1?"l":"";if(i){let s=i==="r"?"l":"r",o=O({},t),a=t[i];t.from=a.from,t.to=a.to,t[i]=a[i],o[i]=a[s],t[s]=o,o.d=Vi(o)}t.d=Vi(t)}function Vi({r:t,l:e}){return(t?e?Math.max(t.d,e.d):t.d:e?e.d:0)+1}var ga={stack:"dbcore",level:0,create:t=>{let e=t.schema.name,n=new ce(t.MIN_KEY,t.MAX_KEY);return K(O({},t),{table:r=>{let i=t.table(r),{schema:s}=i,{primaryKey:o}=s,{extractKey:a,outbound:l}=o,u=K(O({},i),{mutate:c=>{let h=c.trans,y=h.mutatedParts||(h.mutatedParts={}),m=D=>{let E=`idb://${e}/${r}/${D}`;return y[E]||(y[E]=new ce)},v=m(""),p=m(":dels"),{type:_}=c,[b,g]=c.type==="deleteRange"?[c.range]:c.type==="delete"?[c.keys]:c.values.length<50?[[],c.values]:[],C=c.trans._cache;return i.mutate(c).then(D=>{if($(b)){_!=="delete"&&(b=D.results),v.addKeys(b);let E=ns(b,C);!E&&_!=="add"&&p.addKeys(b),(E||g)&&ya(m,s,E,g)}else if(b){let E={from:b.lower,to:b.upper};p.add(E),v.add(E)}else v.add(n),p.add(n),s.indexes.forEach(E=>m(E.name).add(n));return D})}}),d=({query:{index:c,range:h}})=>{var y,m;return[c,new ce((y=h.lower)!==null&&y!==void 0?y:t.MIN_KEY,(m=h.upper)!==null&&m!==void 0?m:t.MAX_KEY)]},f={get:c=>[o,new ce(c.key)],getMany:c=>[o,new ce().addKeys(c.keys)],count:d,query:d,openCursor:d};return j(f).forEach(c=>{u[c]=function(h){let{subscr:y}=A;if(y){let m=g=>{let C=`idb://${e}/${r}/${g}`;return y[C]||(y[C]=new ce)},v=m(""),p=m(":dels"),[_,b]=f[c](h);if(m(_.name||"").add(b),!_.isPrimaryKey)if(c==="count")p.add(n);else{let g=c==="query"&&l&&h.values&&i.query(K(O({},h),{values:!1}));return i[c].apply(this,arguments).then(C=>{if(c==="query"){if(l&&h.values)return g.then(({result:E})=>(v.addKeys(E),C));let D=h.values?C.result.map(a):C.result;h.values?v.addKeys(D):p.addKeys(D)}else if(c==="openCursor"){let D=C,E=h.values;return D&&Object.create(D,{key:{get(){return p.addKey(D.primaryKey),D.key}},primaryKey:{get(){let V=D.primaryKey;return p.addKey(V),V}},value:{get(){return E&&v.addKey(D.primaryKey),D.value}}})}return C})}}return i[c].apply(this,arguments)}}),u}})}};function ya(t,e,n,r){function i(s){let o=t(s.name||"");function a(u){return u!=null?s.extractKey(u):null}let l=u=>s.multiEntry&&$(u)?u.forEach(d=>o.addKey(d)):o.addKey(u);(n||r).forEach((u,d)=>{let f=n&&a(n[d]),c=r&&a(r[d]);W(f,c)!==0&&(f!=null&&l(f),c!=null&&l(c))})}e.indexes.forEach(i)}var Ye=class t{constructor(e,n){this._middlewares={},this.verno=0;let r=t.dependencies;this._options=n=O({addons:t.addons,autoOpen:!0,indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange},n),this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange};let{addons:i}=n;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;let s={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:T,dbReadyPromise:null,cancelOpen:T,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};s.dbReadyPromise=new w(o=>{s.dbReadyResolve=o}),s.openCanceller=new w((o,a)=>{s.cancelOpen=a}),this._state=s,this.name=e,this.on=Dt(this,"populate","blocked","versionchange","close",{ready:[pr,T]}),this.on.ready.subscribe=Si(this.on.ready.subscribe,o=>(a,l)=>{t.vip(()=>{let u=this._state;if(u.openComplete)u.dbOpenError||w.resolve().then(a),l&&o(a);else if(u.onReadyBeingFired)u.onReadyBeingFired.push(a),l&&o(a);else{o(a);let d=this;l||o(function f(){d.on.ready.unsubscribe(a),d.on.ready.unsubscribe(f)})}})}),this.Collection=To(this),this.Table=Io(this),this.Transaction=Go(this),this.Version=na(this),this.WhereClause=jo(this),this.on("versionchange",o=>{o.newVersion>0?console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`),this.close()}),this.on("blocked",o=>{!o.newVersion||o.newVersion<o.oldVersion?console.warn(`Dexie.delete('${this.name}') was blocked`):console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${o.oldVersion/10}`)}),this._maxKey=yt(n.IDBKeyRange),this._createTransaction=(o,a,l,u)=>new this.Transaction(o,a,l,this._options.chromeTransactionDurability,u),this._fireOnBlocked=o=>{this.on("blocked").fire(o),ct.filter(a=>a.name===this.name&&a!==this&&!a._state.vcFired).map(a=>a.on("versionchange").fire(o))},this.use(ca),this.use(ha),this.use(ga),this.use(pa),this.vip=Object.create(this,{_vip:{value:!0}}),i.forEach(o=>o(this))}version(e){if(isNaN(e)||e<.1)throw new M.Type("Given version is not a positive number");if(e=Math.round(e*10)/10,this.idbdb||this._state.isBeingOpened)throw new M.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);let n=this._versions;var r=n.filter(i=>i._cfg.version===e)[0];return r||(r=new this.Version(e),n.push(r),n.sort(qo),r.stores({}),this._state.autoSchema=!1,r)}_whenReady(e){return this.idbdb&&(this._state.openComplete||A.letThrough||this._vip)?e():new w((n,r)=>{if(this._state.openComplete)return r(new M.DatabaseClosed(this._state.dbOpenError));if(!this._state.isBeingOpened){if(!this._options.autoOpen){r(new M.DatabaseClosed);return}this.open().catch(T)}this._state.dbReadyPromise.then(n,r)}).then(e)}use({stack:e,create:n,level:r,name:i}){i&&this.unuse({stack:e,name:i});let s=this._middlewares[e]||(this._middlewares[e]=[]);return s.push({stack:e,create:n,level:r??10,name:i}),s.sort((o,a)=>o.level-a.level),this}unuse({stack:e,name:n,create:r}){return e&&this._middlewares[e]&&(this._middlewares[e]=this._middlewares[e].filter(i=>r?i.create!==r:n?i.name!==n:!1)),this}open(){return aa(this)}_close(){let e=this._state,n=ct.indexOf(this);if(n>=0&&ct.splice(n,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}e.dbReadyPromise=new w(r=>{e.dbReadyResolve=r}),e.openCanceller=new w((r,i)=>{e.cancelOpen=i})}close(){this._close();let e=this._state;this._options.autoOpen=!1,e.dbOpenError=new M.DatabaseClosed,e.isBeingOpened&&e.cancelOpen(e.dbOpenError)}delete(){let e=arguments.length>0,n=this._state;return new w((r,i)=>{let s=()=>{this.close();var o=this._deps.indexedDB.deleteDatabase(this.name);o.onsuccess=R(()=>{sa(this._deps,this.name),r()}),o.onerror=oe(i),o.onblocked=this._fireOnBlocked};if(e)throw new M.InvalidArgument("Arguments not allowed in db.delete()");n.isBeingOpened?n.dbReadyPromise.then(s):s()})}backendDB(){return this.idbdb}isOpen(){return this.idbdb!==null}hasBeenClosed(){let e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"}hasFailed(){return this._state.dbOpenError!==null}dynamicallyOpened(){return this._state.autoSchema}get tables(){return j(this._allTables).map(e=>this._allTables[e])}transaction(){let e=la.apply(this,arguments);return this._transaction.apply(this,e)}_transaction(e,n,r){let i=A.trans;(!i||i.db!==this||e.indexOf("!")!==-1)&&(i=null);let s=e.indexOf("?")!==-1;e=e.replace("!","").replace("?","");let o,a;try{if(a=n.map(u=>{var d=u instanceof this.Table?u.name:u;if(typeof d!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return d}),e=="r"||e===Fn)o=Fn;else if(e=="rw"||e==On)o=On;else throw new M.InvalidArgument("Invalid transaction mode: "+e);if(i){if(i.mode===Fn&&o===On)if(s)i=null;else throw new M.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");i&&a.forEach(u=>{if(i&&i.storeNames.indexOf(u)===-1)if(s)i=null;else throw new M.SubTransaction("Table "+u+" not included in parent transaction.")}),s&&i&&!i.active&&(i=null)}}catch(u){return i?i._promise(null,(d,f)=>{f(u)}):G(u)}let l=ts.bind(null,this,o,a,i,r);return i?i._promise(o,l,"lock"):A.trans?Ze(A.transless,()=>this._whenReady(l)):this._whenReady(l)}table(e){if(!J(this._allTables,e))throw new M.InvalidTable(`Table ${e} does not exist`);return this._allTables[e]}},va=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",lr=class{constructor(e){this._subscribe=e}subscribe(e,n,r){return this._subscribe(!e||typeof e=="function"?{next:e,error:n,complete:r}:e)}[va](){return this}};function rs(t,e){return j(e).forEach(n=>{let r=t[n]||(t[n]=new ce);ln(r,e[n])}),t}function _a(t){let e=!1,n,r=new lr(i=>{let s=dr(t);function o(v){s&&Je();let p=()=>De(t,{subscr:v,trans:null}),_=A.trans?Ze(A.transless,p):p();return s&&_.then(me,me),_}let a=!1,l={},u={},d={get closed(){return a},unsubscribe:()=>{a=!0,Ae.storagemutated.unsubscribe(y)}};i.start&&i.start(d);let f=!1,c=!1;function h(){return j(u).some(v=>l[v]&&ma(l[v],u[v]))}let y=v=>{rs(l,v),h()&&m()},m=()=>{if(f||a)return;l={};let v={},p=o(v);c||(Ae(gt,y),c=!0),f=!0,Promise.resolve(p).then(_=>{e=!0,n=_,f=!1,!a&&(h()?m():(l={},u=v,i.next&&i.next(_)))},_=>{f=!1,e=!1,i.error&&i.error(_),d.unsubscribe()})};return m(),d});return r.hasValue=()=>e,r.getValue=()=>n,r}var ur;try{ur={indexedDB:k.indexedDB||k.mozIndexedDB||k.webkitIndexedDB||k.msIndexedDB,IDBKeyRange:k.IDBKeyRange||k.webkitIDBKeyRange}}catch{ur={indexedDB:null,IDBKeyRange:null}}var Ie=Ye;qe(Ie,K(O({},dn),{delete(t){return new Ie(t,{addons:[]}).delete()},exists(t){return new Ie(t,{addons:[]}).open().then(e=>(e.close(),!0)).catch("NoSuchDatabaseError",()=>!1)},getDatabaseNames(t){try{return ra(Ie.dependencies).then(t)}catch{return G(new M.MissingAPI)}},defineClass(){function t(e){z(this,e)}return t},ignoreTransaction(t){return A.trans?Ze(A.transless,t):t()},vip:sr,async:function(t){return function(){try{var e=or(t.apply(this,arguments));return!e||typeof e.then!="function"?w.resolve(e):e}catch(n){return G(n)}}},spawn:function(t,e,n){try{var r=or(t.apply(n,e||[]));return!r||typeof r.then!="function"?w.resolve(r):r}catch(i){return G(i)}},currentTransaction:{get:()=>A.trans||null},waitFor:function(t,e){let n=w.resolve(typeof t=="function"?Ie.ignoreTransaction(t):t).timeout(e||6e4);return A.trans?A.trans.waitFor(n):n},Promise:w,debug:{get:()=>ae,set:t=>{ki(t,t==="dexie"?()=>!0:Yi)}},derive:Xe,extend:z,props:qe,override:Si,Events:Dt,on:Ae,liveQuery:_a,extendObservabilitySet:rs,getByKeyPath:fe,setByKeyPath:re,delByKeyPath:to,shallowClone:Oi,deepClone:_t,getObjectDiff:Dr,cmp:W,asap:Ii,minKey:Yn,addons:[],connections:ct,errnames:fr,dependencies:ur,semVer:bi,version:bi.split(".").map(t=>parseInt(t)).reduce((t,e,n)=>t+e/Math.pow(10,n*2))}));Ie.maxKey=yt(Ie.dependencies.IDBKeyRange);typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Ae(gt,t=>{if(!he){let e;hn?(e=document.createEvent("CustomEvent"),e.initCustomEvent(Ce,!0,!0,t)):e=new CustomEvent(Ce,{detail:t}),he=!0,dispatchEvent(e),he=!1}}),addEventListener(Ce,({detail:t})=>{he||un(t)}));function un(t){let e=he;try{he=!0,Ae.storagemutated.fire(t)}finally{he=e}}var he=!1;if(typeof BroadcastChannel<"u"){let t=new BroadcastChannel(Ce);typeof t.unref=="function"&&t.unref(),Ae(gt,e=>{he||t.postMessage(e)}),t.onmessage=e=>{e.data&&un(e.data)}}else if(typeof self<"u"&&typeof navigator<"u"){Ae(gt,e=>{try{he||(typeof localStorage<"u"&&localStorage.setItem(Ce,JSON.stringify({trig:Math.random(),changedParts:e})),typeof self.clients=="object"&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach(n=>n.postMessage({type:Ce,changedParts:e})))}catch{}}),typeof addEventListener<"u"&&addEventListener("storage",e=>{if(e.key===Ce){let n=JSON.parse(e.newValue);n&&un(n.changedParts)}});let t=self.document&&navigator.serviceWorker;t&&t.addEventListener("message",ba)}function ba({data:t}){t&&t.type===Ce&&un(t.changedParts)}w.rejectionMapper=co;ki(ae,Yi);var is=(()=>{let e=class e extends Ye{constructor(){super("membersDatabase"),this.version(1).stores({members:"id,firstName,secondName,finalName,age"}),this.membersDB=this.table("members")}getMembers(){return this.membersDB.toArray()}addMember(r){return Be(this,null,function*(){return this.membersDB.add(r).catch(i=>Promise.reject(i))})}deleteMember(r){this.membersDB.delete(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=mn({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function Ca(t,e){if(t&1){let n=wn();P(0,"tr")(1,"td"),B(2),F(),P(3,"td"),B(4),F(),P(5,"td"),B(6),F(),P(7,"td"),B(8),F(),P(9,"td"),B(10),F(),P(11,"td",5)(12,"button",2),ne("click",function(){let s=xt(n).$implicit,o=xe();return St(o.deleteMember(s))}),B(13,"Delete"),F()()()}if(t&2){let n=e.$implicit;X(2),ve(n.id),X(2),ve(n.firstName),X(2),ve(n.secondName),X(2),ve(n.finalName),X(2),ve(n.age)}}function Da(t,e){if(t&1){let n=wn();P(0,"div",6)(1,"div",7)(2,"span",8),ne("click",function(){xt(n);let i=xe();return St(i.closeAddMemberModal())}),B(3,"\xD7"),F(),P(4,"app-form-members",9),ne("memberAdded",function(i){xt(n);let s=xe();return St(s.addMember(i))}),F()()()}if(t&2){let n=xe();X(4),ye("errorMessage",n.errorMessage)}}var ss=(()=>{let e=class e{constructor(r){this.MembersService=r,this.members=[],this.membersModalShow=!1,this.errorMessage="",this.openAddMemberModal=()=>{this.membersModalShow=!0},this.closeAddMemberModal=()=>{this.membersModalShow=!1}}ngOnInit(){this.loadMembers()}loadMembers(){return Be(this,null,function*(){this.members=yield this.MembersService.getMembers()})}addMember(r){return Be(this,null,function*(){yield this.MembersService.addMember(r).then(i=>{console.log("Operation succeeded:",i),this.loadMembers(),this.closeAddMemberModal(),alert("Member added Successfully!")}).catch(i=>{this.errorMessage=i.message,console.error("Operation failed:",i)})})}deleteMember(r){return Be(this,null,function*(){console.log("table",r),yield this.MembersService.deleteMember(r.id),this.loadMembers()})}};e.\u0275fac=function(i){return new(i||e)(U(is))},e.\u0275cmp=Ke({type:e,selectors:[["app-table-members"]],standalone:!0,features:[je],decls:23,vars:2,consts:[[1,"table-view"],[1,"table-header"],[3,"click"],[4,"ngFor","ngForOf"],["class","modal",4,"ngIf"],[2,"width","60px"],[1,"modal"],[1,"modal-content"],[1,"close",3,"click"],[3,"errorMessage","memberAdded"]],template:function(i,s){i&1&&(P(0,"div",0)(1,"div",1)(2,"h2"),B(3,"Members Table"),F(),P(4,"button",2),ne("click",function(){return s.openAddMemberModal()}),B(5,"Add Member"),F()(),P(6,"table")(7,"thead")(8,"tr")(9,"th"),B(10,"ID"),F(),P(11,"th"),B(12,"First Name"),F(),P(13,"th"),B(14,"Second Name"),F(),P(15,"th"),B(16,"Final Name"),F(),P(17,"th"),B(18,"Age"),F(),se(19,"th"),F()(),P(20,"tbody"),nt(21,Ca,14,5,"tr",3),F()()(),nt(22,Da,5,1,"div",4)),i&2&&(X(21),ye("ngForOf",s.members),X(1),ye("ngIf",s.membersModalShow))},dependencies:[Ge,Fr,It,mi],styles:[".table-view[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:80%;margin:auto}.table-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}table[_ngcontent-%COMP%]{border-collapse:collapse;overflow-y:auto;max-height:300px;border:1px solid #ddd}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{border:1px solid #ddd;padding:10px;text-align:center}th[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff;font-size:16px;font-weight:400}td[_ngcontent-%COMP%]:last-child{white-space:nowrap!important}button[_ngcontent-%COMP%]{padding:10px;background-color:#4caf50;color:#fff;border:none;cursor:pointer;border-radius:5px;font-size:16px;float:right}button[_ngcontent-%COMP%]:hover{background-color:#45a049}.modal[_ngcontent-%COMP%]{position:fixed;z-index:1;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:#0006}.modal-content[_ngcontent-%COMP%]{background-color:#fefefe;margin:10% auto;padding:20px;border:1px solid #888;width:400px}.close[_ngcontent-%COMP%]{color:#aaa;float:right;font-size:28px;font-weight:700}.close[_ngcontent-%COMP%]:hover, .close[_ngcontent-%COMP%]:focus{color:#000;text-decoration:none;cursor:pointer}"]});let t=e;return t})();var os=(()=>{let e=class e{constructor(){this.title="angular-members-table"}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Ke({type:e,selectors:[["app-root"]],standalone:!0,features:[je],decls:2,vars:0,template:function(i,s){i&1&&(P(0,"main"),se(1,"app-table-members"),F())},dependencies:[Ge,ss],styles:["main[_ngcontent-%COMP%]{font-family:sans-serif}"]});let t=e;return t})();var as=[];var ls={providers:[kr(as),Pr()]};var Ea={providers:[Tr()]},us=Ir(ls,Ea);var Aa=()=>Or(os,us),Ml=Aa;export{Ml as a};
